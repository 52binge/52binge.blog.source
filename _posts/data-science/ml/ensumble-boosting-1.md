---
title: Ensemble Learning (part1)
date: 2018-04-07 16:08:21
categories: data-science
tags: Ensemble
---

Ensemble learningï¼ˆé›†æˆå­¦ä¹ ï¼‰ï¼šæ˜¯ç›®å‰æœºå™¨å­¦ä¹ çš„ä¸€å¤§çƒ­é—¨æ–¹å‘ï¼Œæ‰€è°“é›†æˆå­¦ä¹ ç®€å•ç†è§£å°±æ˜¯æŒ‡é‡‡ç”¨å¤šä¸ªåˆ†ç±»å™¨å¯¹æ•°æ®é›†è¿›è¡Œé¢„æµ‹ï¼Œä»è€Œæé«˜æ•´ä½“åˆ†ç±»å™¨çš„æ³›åŒ–èƒ½åŠ›ã€‚

<!-- more -->

1. Bootstraping
2. Baggingã€Boostingã€Stacking

## Bootstraping

Bootstrapingçš„åç§°æ¥è‡ªæˆè¯­ â€œpull up by your own bootstrapsâ€ï¼Œæ„æ€æ˜¯ä¾é ä½ è‡ªå·±çš„èµ„æºï¼Œå®ƒæ˜¯ä¸€ç§æœ‰æ”¾å›çš„æŠ½æ ·æ–¹æ³•.

> æ³¨:Bootstrapæœ¬ä¹‰æ˜¯æŒ‡é«˜é´å­å£åé¢çš„æ‚¬æŒ‚ç‰©ã€å°ç¯ã€å¸¦å­ï¼Œæ˜¯ç©¿é´å­æ—¶ç”¨æ‰‹å‘ä¸Šæ‹‰çš„å·¥å…·ã€‚â€œpull up by your own bootstrapsâ€å³â€œé€šè¿‡æ‹‰é´å­è®©è‡ªå·±ä¸Š å‡â€ï¼Œæ„æ€æ˜¯â€œä¸å¯èƒ½å‘ç”Ÿçš„äº‹æƒ…â€ã€‚åæ¥æ„æ€å‘ ç”Ÿäº†è½¬å˜ï¼Œéšå–»â€œä¸éœ€è¦å¤–ç•Œå¸®åŠ©ï¼Œä»…ä¾é è‡ªèº«åŠ› é‡è®©è‡ªå·±å˜å¾—æ›´å¥½â€

bootstraping çš„æ€æƒ³å’Œæ­¥éª¤å¦‚ä¸‹ï¼š

ä¸¾ä¸ªğŸŒ°ï¼šæˆ‘è¦ç»Ÿè®¡é±¼å¡˜é‡Œé¢çš„é±¼çš„æ¡æ•°ï¼Œæ€ä¹ˆç»Ÿè®¡å‘¢ï¼Ÿå‡è®¾é±¼å¡˜æ€»å…±æœ‰é±¼1000æ¡ï¼Œæˆ‘æ˜¯å¼€äº†ä¸Šå¸è§†è§’çš„ï¼Œä½†æ˜¯ä½ æ˜¯ä¸çŸ¥é“é‡Œé¢æœ‰å¤šå°‘ã€‚

æ­¥éª¤ï¼š

1. æ‰¿åŒ…é±¼å¡˜ï¼Œä¸è®©åˆ«äººæé±¼(è§„å®šæ€»ä½“åˆ†å¸ƒä¸å˜)ã€‚
2. è‡ªå·±æé±¼ï¼Œæ100æ¡ï¼Œéƒ½æ‰“ä¸Šæ ‡ç­¾(æ„é€ æ ·æœ¬)
3. æŠŠé±¼æ”¾å›é±¼å¡˜ï¼Œä¼‘æ¯ä¸€æ™š(ä½¿ä¹‹æ··å…¥æ•´ä¸ªé±¼ç¾¤ï¼Œç¡®ä¿ä¹‹åæŠ½æ ·éšæœº)
4. å¼€å§‹æé±¼ï¼Œæ¯æ¬¡æ100æ¡ï¼Œæ•°ä¸€ä¸‹ï¼Œè‡ªå·±æ˜¨å¤©æ ‡è®°çš„é±¼æœ‰å¤šå°‘æ¡ï¼Œå æ¯”å¤šå°‘(ä¸€æ¬¡é‡é‡‡æ ·å–åˆ†å¸ƒ)ã€‚
5. é‡å¤3ï¼Œ4æ­¥éª¤næ¬¡ã€‚å»ºç«‹åˆ†å¸ƒã€‚

> å‡è®¾ä¸€ä¸‹ï¼Œç¬¬ä¸€æ¬¡é‡æ–°æ•é±¼100æ¡ï¼Œå‘ç°é‡Œé¢æœ‰æ ‡è®°çš„é±¼12æ¡ï¼Œè®°ä¸‹ä¸º12%ï¼Œæ”¾å›å»ï¼Œå†æ•é±¼100æ¡ï¼Œå‘ç°æ ‡è®°çš„ä¸º9æ¡ï¼Œè®°ä¸‹9%ï¼Œé‡å¤é‡å¤å¥½å¤šæ¬¡ä¹‹åï¼Œå‡è®¾å–ç½®ä¿¡åŒºé—´95%ï¼Œä½ ä¼šå‘ç°ï¼Œæ¯æ¬¡æ•é±¼å¹³å‡åœ¨10æ¡å·¦å³æœ‰æ ‡è®°ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥å¤§è‡´æ¨æµ‹å‡ºé±¼å¡˜æœ‰1000æ¡å·¦å³ã€‚å…¶å®æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ç±»ä¼¼äºä¸€ä¸ªæ¯”ä¾‹é—®é¢˜ã€‚è¿™ä¹Ÿæ˜¯å› ä¸ºæå‡ºè€…Efronç»™ç»Ÿè®¡å­¦é¡¶çº§æœŸåˆŠæŠ•ç¨¿çš„æ—¶å€™è¢«æ‹’ç»çš„ç†ç”±--"å¤ªç®€å•"ã€‚è¿™ä¹Ÿå°±è§£é‡Šäº†ï¼Œä¸ºä»€ä¹ˆåœ¨å°æ ·æœ¬çš„æ—¶å€™ï¼Œbootstrapæ•ˆæœè¾ƒå¥½ï¼Œä½ è¿™æ ·æƒ³ï¼Œå¦‚æœæˆ‘æƒ³ç»Ÿè®¡å¤§æµ·é‡Œæœ‰å¤šå°‘é±¼ï¼Œä½ æ ‡è®°100000æ¡ä¹Ÿæ²¡ç”¨å•Šï¼Œå› ä¸ºå®é™…æ•°é‡å¤ªè¿‡åºå¤§ï¼Œä½ å–çš„æ ·æœ¬ç›¸æ¯”äºå¤ªè¿‡æ¸ºå°ï¼Œæœ€å®é™…çš„å°±æ˜¯ï¼Œä½ ä¸‹æ¬¡å†æ•100000çš„æ—¶å€™ï¼Œå‘ç°ä¸€æ¡éƒ½æ²¡æœ‰æ ‡è®°ï¼Œï¼Œï¼Œè¿™TMå°±å°´å°¬äº†ã€‚ã€‚

**Bootstrap ç»å…¸è¯­å½•**

> Bootstrapæ˜¯ç°ä»£ç»Ÿè®¡å­¦è¾ƒä¸ºæµè¡Œçš„ä¸€ç§ç»Ÿè®¡æ–¹æ³•ï¼Œåœ¨å°æ ·æœ¬æ—¶æ•ˆæœå¾ˆå¥½ã€‚é€šè¿‡æ–¹å·®çš„ä¼°è®¡å¯ä»¥æ„é€ ç½®ä¿¡åŒºé—´ç­‰ï¼Œå…¶è¿ç”¨èŒƒå›´å¾—åˆ°è¿›ä¸€æ­¥å»¶ä¼¸ã€‚
> å°±æ˜¯ä¸€ä¸ªåœ¨è‡ªèº«æ ·æœ¬é‡é‡‡æ ·çš„æ–¹æ³•æ¥ä¼°è®¡çœŸå®åˆ†å¸ƒçš„é—®é¢˜

> å½“æˆ‘ä»¬ä¸çŸ¥é“æ ·æœ¬åˆ†å¸ƒçš„æ—¶å€™ï¼Œbootstrapæ–¹æ³•æœ€æœ‰ç”¨ã€‚

## Ensemble learning

äº†è§£ boosting å’Œ bagging ä¹‹å‰ï¼Œå…ˆäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ ensembleï¼Œä¸€å¥è¯ï¼Œä¸‰ä¸ªè‡­çš®åŒ é¡¶ä¸ªè¯¸è‘›äº®ï¼Œä¸€ç®­æ˜“æŠ˜åç®­éš¾æŠ˜ï¼Œåƒé‡Œä¹‹å ¤æºƒäºèšç©´ â€¦ğŸ˜„ğŸ˜„ğŸ˜„ ï¼Œåœ¨åˆ†ç±»çš„è¡¨ç°ä¸Šå°±æ˜¯ï¼Œå¤šä¸ªå¼±åˆ†ç±»å™¨ç»„åˆå˜æˆå¼ºåˆ†ç±»å™¨ã€‚

{% image "/images/ml/ensumble/ml-ensemble-1.png", width="500px" %}

> å‡è®¾å„å¼±åˆ†ç±»å™¨é—´å…·æœ‰ä¸€å®šå·®å¼‚æ€§ï¼ˆå¦‚ä¸åŒçš„ç®—æ³•ï¼Œæˆ–ç›¸åŒç®—æ³•ä¸åŒå‚æ•°é…ç½®ï¼‰ï¼Œè¿™ä¼šå¯¼è‡´ç”Ÿæˆçš„åˆ†ç±»å†³ç­–è¾¹ç•Œä¸åŒï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä»¬åœ¨å†³ç­–æ—¶ä¼šçŠ¯ä¸åŒçš„é”™è¯¯ã€‚å°†å®ƒä»¬ç»“åˆåèƒ½å¾—åˆ°æ›´åˆç†çš„è¾¹ç•Œï¼Œå‡å°‘æ•´ä½“é”™è¯¯ï¼Œå®ç°æ›´å¥½çš„åˆ†ç±»æ•ˆæœã€‚

### Bagging (bootstrap aggregation)

> baggingï¼šä»è®­ç»ƒé›†ä»è¿›è¡Œå­æŠ½æ ·ç»„æˆæ¯ä¸ªåŸºæ¨¡å‹æ‰€éœ€è¦çš„å­è®­ç»ƒé›†ï¼Œå¯¹æ‰€æœ‰åŸºæ¨¡å‹é¢„æµ‹çš„ç»“æœè¿›è¡Œç»¼åˆäº§ç”Ÿæœ€ç»ˆçš„é¢„æµ‹ç»“æœ,è‡³äºä¸ºä»€ä¹ˆå«bootstrap aggregationï¼Œå› ä¸ºå®ƒæŠ½å–è®­ç»ƒæ ·æœ¬çš„æ—¶å€™é‡‡ç”¨çš„å°±æ˜¯bootstrapçš„æ–¹æ³•ï¼

Bagging ç­–ç•¥è¿‡ç¨‹ ğŸ˜„ :

1. ä»æ ·æœ¬é›†ä¸­é‡é‡‡æ ·(æœ‰é‡å¤çš„)é€‰å‡ºnä¸ªæ ·æœ¬
2. åœ¨æ‰€æœ‰å±æ€§ä¸Šï¼Œå¯¹è¿™nä¸ªæ ·æœ¬å»ºç«‹åˆ†ç±»å™¨ (ID3ã€C4.5ã€CARTã€SVMã€Logisticå›å½’ç­‰)
3. é‡å¤ä»¥ä¸Šä¸¤æ­¥mæ¬¡ï¼Œå³è·å¾—äº†mä¸ªåˆ†ç±»å™¨
4. å°†æ•°æ®æ”¾åœ¨è¿™mä¸ªåˆ†ç±»å™¨ä¸Šï¼Œæœ€åæ ¹æ®è¿™mä¸ªåˆ†ç±»å™¨çš„æŠ•ç¥¨ç»“æœï¼Œå†³å®šæ•°æ®å±äºå“ªä¸€ç±».
5. æŠ•ç¥¨æœºåˆ¶ (å¤šæ•°æœä»å°‘æ•°, æ°‘ä¸»æ”¿æ²») çœ‹åˆ°åº•åˆ†åˆ°å“ªä¸€ç±»(åˆ†ç±»é—®é¢˜)

{% image "/images/ml/ensumble/ml-ensemble-2-bagging.jpeg", width="600px" %}

**Bagging ä»£è¡¨ç®—æ³• - Random Forest**

éšæœºæ£®æ—ï¼Œå®ƒä¸ä»…å¯ä»¥ç”¨æ¥åšåˆ†ç±»ï¼Œä¹Ÿå¯ç”¨æ¥åšå›å½’å³é¢„æµ‹ï¼Œä¸€èˆ¬éšæœºæ£®æ—æœºç”±å¤šä¸ªå†³ç­–æ ‘æ„æˆï¼Œç›¸æ¯”äºå•ä¸ªå†³ç­–æ ‘ç®—æ³•ï¼Œå®ƒåˆ†ç±»ã€é¢„æµ‹æ•ˆæœæ›´å¥½ï¼Œä¸å®¹æ˜“å‡ºç°è¿‡åº¦æ‹Ÿåˆçš„æƒ…å†µã€‚

1.è®­ç»ƒæ ·æœ¬é€‰æ‹©æ–¹é¢çš„Randomï¼š

> Bootstrapæ–¹æ³•éšæœºé€‰æ‹©å­æ ·æœ¬

2.ç‰¹å¾é€‰æ‹©æ–¹é¢çš„Randomï¼š

> å±æ€§é›†ä¸­éšæœºé€‰æ‹©kä¸ªå±æ€§ï¼Œæ¯ä¸ªæ ‘èŠ‚ç‚¹åˆ†è£‚æ—¶ï¼Œä»è¿™éšæœºçš„kä¸ªå±æ€§ï¼Œé€‰æ‹©æœ€ä¼˜çš„(å¦‚ä½•é€‰æ‹©æœ€ä¼˜åˆæœ‰å„ç§æœ€å¤§å¢ç›Šçš„æ–¹æ³•ï¼Œä¸åœ¨æœ¬æ–‡è®¨è®ºèŒƒå›´å†…)ã€‚

**å†³ç­–æ ‘**

å†³ç­–æ ‘å¯¹è®­ç»ƒæ ·æœ¬æœ‰è‰¯å¥½çš„åˆ†ç±»èƒ½åŠ›ï¼Œåªè¦æˆ‘ä»¬çš„å±‚æ•°ä¸åŠ é™åˆ¶ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥æŠŠå®ƒåˆ†çš„æ²¡æœ‰ä»»ä½•è¯¯å·®ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´ä½ çš„æ³›åŒ–èƒ½åŠ›å¾ˆå¼±ã€‚ ç¼“è§£çš„æ–¹æ³•å°±æ˜¯ 1. å‰ªæ 2. éšæœºæ£®æ—

å‰ªæ æˆ‘è¿˜æ²¡ç”¨è¿‡ï¼Œæ‰€ä»¥æˆ‘ä»¬çœ‹å¸¸ç”¨çš„ éšæœºæ£®æ— Romdom Forest

å†³ç­–æ ‘ ï¼š ç‰¹å¾é€‰æ‹©

1. ID3 ä»…å…·æœ‰æ•™å­¦ä»·å€¼
2. gini ç³»æ•°ï¼Œä½œä¸ºæŒ‡æ ‡æ¯”è¾ƒå¤šï¼Œåœ¨å®è·µå½“ä¸­

**Random Forest æ„é€ æµç¨‹**

{% image "/images/ml/ensumble/ml-ensemble-3-bagging.jpeg", width="600px" %}

> 1. ç”¨ Random(è®­ç»ƒæ ·æœ¬ç”¨Bootstrapæ–¹æ³•ï¼Œé€‰æ‹©åˆ†ç¦»å¶å­èŠ‚ç‚¹ç”¨ä¸Šé¢çš„2)çš„æ–¹å¼æ„é€ ä¸€æ£µå†³ç­–æ ‘(CART)
> 2. ç”¨1çš„æ–¹æ³•æ„é€ å¾ˆå¤šå†³ç­–æ ‘, ä¸å‰ªæ, è®¸å¤šå†³ç­–æ ‘æ„æˆä¸€ç‰‡æ£®æ—ï¼Œå†³ç­–æ ‘ä¹‹é—´æ²¡æœ‰è”ç³»
> 3. æµ‹è¯•æ•°æ®è¿›å…¥æ¯ä¸€æ£µå†³ç­–æ ‘ï¼Œæ¯æ£µæ ‘åšå‡ºè‡ªå·±çš„åˆ¤æ–­ï¼Œç„¶åæŠ•ç¥¨é€‰å‡ºæœ€ç»ˆæ‰€å±ç±»åˆ«(é»˜è®¤æ¯æ£µæ ‘æƒé‡ä¸€è‡´)

**Random Forest ä¼˜ç‚¹**

> 1. ä¸å®¹æ˜“å‡ºç°è¿‡æ‹Ÿåˆï¼Œå› ä¸ºé€‰æ‹©è®­ç»ƒæ ·æœ¬çš„æ—¶å€™å°±ä¸æ˜¯å…¨éƒ¨æ ·æœ¬ã€‚
> 2. æ—¢å¯å¤„ç†å±æ€§ä¸ºç¦»æ•£å€¼çš„é‡ï¼Œæ¯”å¦‚ID3ç®—æ³•æ¥æ„é€ æ ‘ï¼Œä¹Ÿå¯ä»¥å¤„ç†å±æ€§ä¸ºè¿ç»­å€¼çš„é‡ï¼Œæ¯”å¦‚C4.5ç®—æ³•æ¥æ„é€ æ ‘
> 3. å¯¹äºé«˜ç»´æ•°æ®é›†çš„å¤„ç†èƒ½åŠ›ä»¤äººå…´å¥‹ï¼Œå®ƒå¯ä»¥å¤„ç†æˆåƒä¸Šä¸‡çš„è¾“å…¥å˜é‡ï¼Œå¹¶ç¡®å®šæœ€é‡è¦çš„å˜é‡ï¼Œå› æ­¤è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªä¸é”™çš„é™ç»´æ–¹æ³•ã€‚è¯¥æ¨¡å‹èƒ½å¤Ÿè¾“å‡ºå˜é‡çš„é‡è¦æ€§ç¨‹åº¦ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸ä¾¿åˆ©çš„åŠŸèƒ½ã€‚
> 4. åˆ†ç±»ä¸å¹³è¡¡çš„æƒ…å†µæ—¶ï¼Œéšæœºæ£®æ—èƒ½å¤Ÿæä¾›å¹³è¡¡æ•°æ®é›†è¯¯å·®çš„æœ‰æ•ˆæ–¹æ³•

**Random Forest ç¼ºç‚¹**

> 1. éšæœºæ£®æ—åœ¨è§£å†³å›å½’é—®é¢˜æ—¶å¹¶æ²¡æœ‰åƒå®ƒåœ¨åˆ†ç±»ä¸­è¡¨ç°çš„é‚£ä¹ˆå¥½ï¼Œè¿™æ˜¯å› ä¸ºå®ƒå¹¶ä¸èƒ½ç»™å‡ºä¸€ä¸ªè¿ç»­å‹çš„è¾“å‡ºã€‚å½“è¿›è¡Œå›å½’æ—¶ï¼Œéšæœºæ£®æ—ä¸èƒ½å¤Ÿä½œå‡ºè¶…è¶Šè®­ç»ƒé›†æ•°æ®èŒƒå›´çš„é¢„æµ‹ï¼Œè¿™å¯èƒ½å¯¼è‡´åœ¨å¯¹æŸäº›è¿˜æœ‰ç‰¹å®šå™ªå£°çš„æ•°æ®è¿›è¡Œå»ºæ¨¡æ—¶å‡ºç°è¿‡åº¦æ‹Ÿåˆã€‚
> 2. å¯¹äºè®¸å¤šç»Ÿè®¡å»ºæ¨¡è€…æ¥è¯´ï¼Œéšæœºæ£®æ—ç»™äººçš„æ„Ÿè§‰åƒæ˜¯ä¸€ä¸ªé»‘ç›’å­â€”â€”ä½ å‡ ä¹æ— æ³•æ§åˆ¶æ¨¡å‹å†…éƒ¨çš„è¿è¡Œï¼Œåªèƒ½åœ¨ä¸åŒçš„å‚æ•°å’Œéšæœºç§å­ä¹‹é—´è¿›è¡Œå°è¯•ã€‚

> ä¼˜ç¼ºç‚¹ï¼Œéœ€è¦ä¸æ°ç¥å•†è®¨å†?


## Reference article

- [Baggingï¼ˆBootstrap aggregatingï¼‰ã€éšæœºæ£®æ—ï¼ˆrandom forestsï¼‰ã€AdaBoost][l1]
- [Bootstrap(è‡ªåŠ©æ³•)ï¼ŒBaggingï¼ŒBoosting(æå‡)][l2]

[l1]: https://www.jianshu.com/p/708dff71df3a
[l2]: https://blog.csdn.net/xlinsist/article/details/51475345

[img1]: /images/ml/ensumble/ml-ensemble-1.png
[img2]: /images/ml/ensumble/ml-ensemble-2-bagging.jpeg


