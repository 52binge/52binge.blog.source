---
title: Ensemble Learning (part2)
toc: true
date: 2018-05-11 16:08:21
categories: machine-learning
tags: machine-learning
mathjax: true
---

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX"],
    tex2jax: {
      inlineMath: [ ['$','$'], ['\\(','\\)'] ],
      displayMath: [ ['$$','$$']],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML,http://myserver.com/MathJax/config/local/local.js">
</script>

æå‡ï¼ˆboostingï¼‰æ–¹æ³•æ˜¯ä¸€ç±»åº”ç”¨å¹¿æ³›ä¸”éå¸¸æœ‰æ•ˆçš„ç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‚

- Boosting æ¦‚å¿µ
- ä»£è¡¨æ€§ Boosting ç®—æ³• AbaBoost ä»‹ç»

<!-- more -->

> ã€ŠAn Empirical Comparison of Supervised Learning Algorithmsã€‹ICML2006.

Adaboost åœ¨å¤„ç†äºŒç±»åˆ†ç±»é—®é¢˜æ—¶ï¼Œéšç€å¼±åˆ†ç±»å™¨çš„ä¸ªæ•°å¢åŠ ï¼Œè®­ç»ƒè¯¯å·®ä¸æµ‹è¯•è¯¯å·®çš„æ›²çº¿å›¾ã€‚

<div class="limg1">
<img src="/images/ml/ml_boosting_adaboost_binary_classification.png" width="400" />
</div>

ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼ŒAdaboostç®—æ³•éšç€æ¨¡å‹å¤æ‚åº¦çš„å¢åŠ ï¼Œæµ‹è¯•è¯¯å·®ï¼ˆçº¢è‰²ç‚¹çº¿ï¼‰åŸºæœ¬ä¿æŒç¨³å®šï¼Œå¹¶æ²¡æœ‰å‡ºç°è¿‡æ‹Ÿåˆçš„ç°è±¡ã€‚

å…¶å®ä¸ä»…æ˜¯Adaboostç®—æ³•æœ‰è¿™ç§è¡¨ç°ï¼ŒBoostingæ–¹æ³•çš„å­¦ä¹ æ€æƒ³å’Œæ¨¡å‹ç»“æ„ä¸Šå¯ä»¥ä¿è¯å…¶ä¸å®¹æ˜“äº§ç”Ÿè¿‡æ‹Ÿåˆï¼ˆé™¤éWeak Learneræœ¬èº«å‡ºç°è¿‡æ‹Ÿåˆï¼‰ã€‚

ä¸‹é¢æˆ‘ä»¬ä¸»è¦æ˜¯ä»æŸå¤±å‡½æ•°çš„å·®å¼‚ï¼Œæ¥ä»‹ç»Boostingçš„å®¶æ—æˆå‘˜ï¼›ç„¶åæˆ‘ä»¬é’ˆå¯¹æ¯ä¸ªå…·ä½“çš„å®¶æ—æˆå‘˜ï¼Œè¯¦ç»†ä»‹ç»å…¶å­¦ä¹ è¿‡ç¨‹å’Œæ ¸å¿ƒå…¬å¼ï¼›æœ€åä»ç®—æ³•åº”ç”¨åœºæ™¯å’Œå·¥å…·æ–¹æ³•ç»™å‡ºç®€å•çš„ä»‹ç»ã€‚

**Boosting**

Boostingæ–¹æ³•åŸºäºè¿™æ ·ä¸€ç§æ€æƒ³ï¼š

> å¯¹äºä¸€ä¸ªå¤æ‚ä»»åŠ¡æ¥è¯´ï¼Œå°†å¤šä¸ªä¸“å®¶çš„åˆ¤å®šè¿›è¡Œé€‚å½“çš„ç»¼åˆå¾—å‡ºçš„åˆ¤æ–­ï¼Œè¦æ¯”å…¶ä¸­ä»»ä½•ä¸€ä¸ªä¸“å®¶å•ç‹¬çš„åˆ¤æ–­å¥½ã€‚
> 
> å°±æ˜¯ "ä¸‰ä¸ªè‡­çš®åŒ é¡¶ä¸ªè¯¸è‘›äº®" â€¦ğŸ˜„ğŸ˜„ğŸ˜„

## 1. æ¦‚ç‡å¯å­¦ä¹ æ€§ (PAC)

PACç†è®ºæ˜¯ç”±2010å¹´å›¾çµå¥–çš„å¾—ä¸»Valiantå’ŒKearnsæå‡ºçš„ä¸€å¥—ç†è®ºä½“ç³»ï¼Œä¸»è¦è®¨è®ºä»€ä¹ˆæ—¶å€™ï¼Œä¸€ä¸ªé—®é¢˜æ˜¯å¯ä»¥è¢«å­¦ä¹ çš„ã€‚

> PACä½“ç³»å®šä¹‰äº†å­¦ä¹ ç®—æ³•çš„å¼ºå¼±ï¼š
> 
> (1) å¼±å­¦ä¹ ç®—æ³• : å¦‚æœå­˜åœ¨ä¸€ä¸ªå¤šé¡¹å¼çš„å­¦ä¹ ç®—æ³•èƒ½å¤Ÿå­¦ä¹ å®ƒï¼Œå­¦ä¹ çš„æ­£ç¡®ç‡ä»…æ¯”éšæœºçŒœæµ‹ç•¥å¥½ï¼Œ
> (2) å¼ºå­¦ä¹ ç®—æ³• : å­˜åœ¨ä¸€ä¸ªå¤šé¡¹å¼çš„å­¦ä¹ ç®—æ³•èƒ½å¤Ÿå­¦ä¹ å®ƒï¼Œå¹¶ä¸”æ­£ç¡®ç‡å¾ˆé«˜

åœ¨æ¦‚ç‡è¿‘ä¼¼æ­£ç¡®ï¼ˆprobably approximately correctï¼ŒPACï¼‰å­¦ä¹ æ¡†æ¶ä¸­ï¼š

> â‘ . ä¸€ä¸ªæ¦‚å¿µï¼ˆä¸€ä¸ªç±»ï¼Œlabelï¼‰ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªå¤šé¡¹å¼çš„å­¦ä¹ ç®—æ³•èƒ½å¤Ÿå­¦ä¹ å®ƒï¼Œå¹¶ä¸”æ­£ç¡®ç‡å¾ˆé«˜ï¼Œé‚£ä¹ˆå°±ç§°è¿™ä¸ªæ¦‚å¿µæ˜¯å¼ºå¯å­¦ä¹ çš„ï¼›
>
> â‘¡. ä¸€ä¸ªæ¦‚å¿µï¼ˆä¸€ä¸ªç±»ï¼Œlabelï¼‰ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªå¤šé¡¹å¼çš„å­¦ä¹ ç®—æ³•èƒ½å¤Ÿå­¦ä¹ å®ƒï¼Œå­¦ä¹ çš„æ­£ç¡®ç‡ä»…æ¯”éšæœºçŒœæµ‹ç•¥å¥½ï¼Œé‚£ä¹ˆå°±ç§°è¿™ä¸ªæ¦‚å¿µæ˜¯å¼±å¯å­¦ä¹ çš„ã€‚
>
 
Valiantå’Œ Kearnsæå‡ºPACå­¦ä¹ æ¨¡å‹ä¸­å¼±å­¦ä¹ ç®—æ³•å’Œå¼ºå­¦ä¹ ç®—æ³•çš„ç­‰ä»·æ€§çŒœæƒ³ï¼š
 
> è¯¥çŒœæƒ³æœ€é‡è¦çš„å«ä¹‰æ˜¯ï¼Œå¦‚æœäºŒè€…ç­‰ä»· ,é‚£ä¹ˆåªéœ€æ‰¾åˆ°ä¸€ä¸ªæ¯”éšæœºçŒœæµ‹ç•¥å¥½çš„å¼±å­¦ä¹ ç®—æ³•å°±å¯ä»¥å°†å…¶æå‡ä¸ºå¼ºå­¦ä¹ ç®—æ³•ï¼Œè€Œä¸å¿…å¯»æ‰¾å¾ˆéš¾è·å¾—çš„å¼ºå­¦ä¹ ç®—æ³•ã€‚
> 
> è¯¥é—®é¢˜çš„é‡è¦æ€§éšå³å¼•èµ·æ–¹æ³•è®ºå¤§å¸ˆçš„è¿½æ§ï¼Œå¤§å®¶éƒ½åœ¨è¯•å›¾è®¾è®¡ç®—æ³•æ¥éªŒè¯PACç†è®ºçš„æ­£ç¡®æ€§ã€‚
> 
> 1996ï¼ŒSchapireæå‡ºä¸€ç§æ–°çš„åå«AdaBoostçš„ç®—æ³•è¯æ˜äº†ä¸Šè¿°çŒœæƒ³ã€‚AdaBoostæŠŠå¤šä¸ªä¸åŒçš„å†³ç­–æ ‘ç”¨ä¸€ç§**ééšæœºçš„æ–¹å¼ç»„åˆ**èµ·æ¥ï¼Œè¡¨ç°å‡ºæƒŠäººçš„æ€§èƒ½ã€‚åŒæ—¶ï¼ŒSchapireè¯æ˜å¼ºå¯å­¦ä¹ ä¸å¼±å¯å­¦ä¹ æ˜¯ç­‰ä»·çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ**åœ¨PACå­¦ä¹ çš„æ¡†æ¶ä¸‹ï¼Œä¸€ä¸ªæ¦‚å¿µæ˜¯å¼ºå¯å­¦ä¹ çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯è¿™ä¸ªæ¦‚å¿µæ˜¯å¼±å¯å­¦ä¹ çš„**ã€‚

Summary : `å¼ºå¯å­¦ä¹ â‡”å¼±å¯å­¦ä¹ `

## 2. ä»Ensembleåˆ°Boosting

å†³ç­–æ ‘å¯¹è®­ç»ƒæ ·æœ¬æœ‰è‰¯å¥½çš„åˆ†ç±»èƒ½åŠ›ï¼Œåªè¦æˆ‘ä»¬çš„å±‚æ•°ä¸åŠ é™åˆ¶ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥æŠŠå®ƒåˆ†çš„æ²¡æœ‰ä»»ä½•è¯¯å·®ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´ä½ çš„æ³›åŒ–èƒ½åŠ›å¾ˆå¼±ã€‚ ç¼“è§£çš„æ–¹æ³•å°±æ˜¯ 1. å‰ªæ 2. éšæœºæ£®æ—

å‰ªæ æˆ‘è¿˜æ²¡ç”¨è¿‡ï¼Œæ‰€ä»¥æˆ‘ä»¬çœ‹å¸¸ç”¨çš„ éšæœºæ£®æ— Romdom Forest

å†³ç­–æ ‘ ï¼š ç‰¹å¾é€‰æ‹©

1. ID3 ä»…å…·æœ‰æ•™å­¦ä»·å€¼
2. gini ç³»æ•°ï¼Œä½œä¸ºæŒ‡æ ‡æ¯”è¾ƒå¤šï¼Œåœ¨å®è·µå½“ä¸­


Boosting æå‡ç®—æ³•ç®€å²

1. Bootstraping
2. Bagging
3. Boosting
4. Stacking

### 2.1 Bootstrapping

Bootstrapingçš„åç§°æ¥è‡ªæˆè¯­ â€œpull up by your own bootstrapsâ€ï¼Œæ„æ€æ˜¯ä¾é ä½ è‡ªå·±çš„èµ„æºï¼Œå®ƒæ˜¯ä¸€ç§æœ‰æ”¾å›çš„æŠ½æ ·æ–¹æ³•.

> æ³¨:Bootstrapæœ¬ä¹‰æ˜¯æŒ‡é«˜é´å­å£åé¢çš„æ‚¬æŒ‚ç‰©ã€å°ç¯ã€å¸¦å­ï¼Œæ˜¯ç©¿é´å­æ—¶ç”¨æ‰‹å‘ä¸Šæ‹‰çš„å·¥å…·ã€‚â€œpull up by your own bootstrapsâ€å³â€œé€šè¿‡æ‹‰é´å­è®©è‡ªå·±ä¸Š å‡â€ï¼Œæ„æ€æ˜¯â€œä¸å¯èƒ½å‘ç”Ÿçš„äº‹æƒ…â€ã€‚åæ¥æ„æ€å‘ ç”Ÿäº†è½¬å˜ï¼Œéšå–»â€œä¸éœ€è¦å¤–ç•Œå¸®åŠ©ï¼Œä»…ä¾é è‡ªèº«åŠ› é‡è®©è‡ªå·±å˜å¾—æ›´å¥½â€

bootstraping çš„æ€æƒ³å’Œæ­¥éª¤å¦‚ä¸‹ï¼š

ä¸¾ä¸ªğŸŒ°ï¼šæˆ‘è¦ç»Ÿè®¡é±¼å¡˜é‡Œé¢çš„é±¼çš„æ¡æ•°ï¼Œæ€ä¹ˆç»Ÿè®¡å‘¢ï¼Ÿå‡è®¾é±¼å¡˜æ€»å…±æœ‰é±¼1000æ¡ï¼Œæˆ‘æ˜¯å¼€äº†ä¸Šå¸è§†è§’çš„ï¼Œä½†æ˜¯ä½ æ˜¯ä¸çŸ¥é“é‡Œé¢æœ‰å¤šå°‘ã€‚

æ­¥éª¤ï¼š

1. æ‰¿åŒ…é±¼å¡˜ï¼Œä¸è®©åˆ«äººæé±¼(è§„å®šæ€»ä½“åˆ†å¸ƒä¸å˜)ã€‚
2. è‡ªå·±æé±¼ï¼Œæ100æ¡ï¼Œéƒ½æ‰“ä¸Šæ ‡ç­¾(æ„é€ æ ·æœ¬)
3. æŠŠé±¼æ”¾å›é±¼å¡˜ï¼Œä¼‘æ¯ä¸€æ™š(ä½¿ä¹‹æ··å…¥æ•´ä¸ªé±¼ç¾¤ï¼Œç¡®ä¿ä¹‹åæŠ½æ ·éšæœº)
4. å¼€å§‹æé±¼ï¼Œæ¯æ¬¡æ100æ¡ï¼Œæ•°ä¸€ä¸‹ï¼Œè‡ªå·±æ˜¨å¤©æ ‡è®°çš„é±¼æœ‰å¤šå°‘æ¡ï¼Œå æ¯”å¤šå°‘(ä¸€æ¬¡é‡é‡‡æ ·å–åˆ†å¸ƒ)ã€‚
5. é‡å¤3ï¼Œ4æ­¥éª¤næ¬¡ã€‚å»ºç«‹åˆ†å¸ƒã€‚

> å‡è®¾ä¸€ä¸‹ï¼Œç¬¬ä¸€æ¬¡é‡æ–°æ•é±¼100æ¡ï¼Œå‘ç°é‡Œé¢æœ‰æ ‡è®°çš„é±¼12æ¡ï¼Œè®°ä¸‹ä¸º12%ï¼Œæ”¾å›å»ï¼Œå†æ•é±¼100æ¡ï¼Œå‘ç°æ ‡è®°çš„ä¸º9æ¡ï¼Œè®°ä¸‹9%ï¼Œé‡å¤é‡å¤å¥½å¤šæ¬¡ä¹‹åï¼Œå‡è®¾å–ç½®ä¿¡åŒºé—´95%ï¼Œä½ ä¼šå‘ç°ï¼Œæ¯æ¬¡æ•é±¼å¹³å‡åœ¨10æ¡å·¦å³æœ‰æ ‡è®°ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥å¤§è‡´æ¨æµ‹å‡ºé±¼å¡˜æœ‰1000æ¡å·¦å³ã€‚å…¶å®æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ç±»ä¼¼äºä¸€ä¸ªæ¯”ä¾‹é—®é¢˜ã€‚è¿™ä¹Ÿæ˜¯å› ä¸ºæå‡ºè€…Efronç»™ç»Ÿè®¡å­¦é¡¶çº§æœŸåˆŠæŠ•ç¨¿çš„æ—¶å€™è¢«æ‹’ç»çš„ç†ç”±--"å¤ªç®€å•"ã€‚è¿™ä¹Ÿå°±è§£é‡Šäº†ï¼Œä¸ºä»€ä¹ˆåœ¨å°æ ·æœ¬çš„æ—¶å€™ï¼Œbootstrapæ•ˆæœè¾ƒå¥½ï¼Œä½ è¿™æ ·æƒ³ï¼Œå¦‚æœæˆ‘æƒ³ç»Ÿè®¡å¤§æµ·é‡Œæœ‰å¤šå°‘é±¼ï¼Œä½ æ ‡è®°100000æ¡ä¹Ÿæ²¡ç”¨å•Šï¼Œå› ä¸ºå®é™…æ•°é‡å¤ªè¿‡åºå¤§ï¼Œä½ å–çš„æ ·æœ¬ç›¸æ¯”äºå¤ªè¿‡æ¸ºå°ï¼Œæœ€å®é™…çš„å°±æ˜¯ï¼Œä½ ä¸‹æ¬¡å†æ•100000çš„æ—¶å€™ï¼Œå‘ç°ä¸€æ¡éƒ½æ²¡æœ‰æ ‡è®°ï¼Œï¼Œï¼Œè¿™TMå°±å°´å°¬äº†ã€‚ã€‚


<!-- more -->

## Reference article

- [æ€»ç»“ï¼šBootstrap(è‡ªåŠ©æ³•)ï¼ŒBaggingï¼ŒBoosting(æå‡)][l5]
- [Baggingï¼ˆBootstrap aggregatingï¼‰ã€éšæœºæ£®æ—ï¼ˆrandom forestsï¼‰ã€AdaBoost][l6]
- [æœºå™¨å­¦ä¹ é€‰è®²ï¼šAdaBoostæ–¹æ³•è¯¦è§£][l4]
- [52caml][l1]
- [ç»Ÿè®¡å­¦ä¹ æ–¹æ³•][l2]
- [Scikit-Learn ä¸­æ–‡æ–‡æ¡£ æ¦‚ç‡æ ¡å‡† - ç›‘ç£å­¦ä¹ ][l3]

[l1]: http://www.52caml.com/head_first_ml/ml-chapter6-boosting-family/
[l2]: https://www.zhihu.com/question/49386395
[l3]: https://blog.csdn.net/u010859707/article/details/78677989
[l4]: http://bbs.quanttech.cn/article/524
[l5]: https://www.jianshu.com/p/708dff71df3a
[l6]: https://blog.csdn.net/xlinsist/article/details/51475345

[img1]: /images/ml/ml_boosting_adaboost_binary_classification.png
[img2]: /images/ml/ml-en-boosting-1.jpg


