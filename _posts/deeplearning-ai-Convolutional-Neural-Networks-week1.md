---
title: Convolutional Neural Networks (week1) - CNN
toc: true
date: 2018-08-21 10:00:21
categories: deeplearning
tags: deeplearning.ai
mathjax: true
---

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX"],
    tex2jax: {
      inlineMath: [ ['$','$'], ['\\(','\\)'] ],
      displayMath: [ ['$$','$$']],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML,http://myserver.com/MathJax/config/local/local.js">
</script>

-	ç†è§£å¦‚ä½•æ­å»ºä¸€ä¸ªç¥ç»ç½‘ç»œï¼ŒåŒ…æ‹¬æœ€æ–°çš„å˜ä½“ï¼Œä¾‹å¦‚æ®‹ä½™ç½‘ç»œã€‚
-	çŸ¥é“å¦‚ä½•å°†å·ç§¯ç½‘ç»œåº”ç”¨åˆ°è§†è§‰æ£€æµ‹å’Œè¯†åˆ«ä»»åŠ¡ã€‚
-	çŸ¥é“å¦‚ä½•ä½¿ç”¨ç¥ç»é£æ ¼è¿ç§»ç”Ÿæˆè‰ºæœ¯ã€‚
-	èƒ½å¤Ÿåœ¨å›¾åƒã€è§†é¢‘ä»¥åŠå…¶ä»–2Dæˆ–3Dæ•°æ®ä¸Šåº”ç”¨è¿™äº›ç®—æ³•ã€‚

<!-- more -->

## 1. Computer vision

<img src="/images/deeplearning/C4W1-1_1.png" width="700" />

<img src="/images/deeplearning/C4W1-2_1.png" width="700" />

> å¦‚å›¾ç¤ºï¼Œä¹‹å‰è¯¾ç¨‹ä¸­ä»‹ç»çš„éƒ½æ˜¯ 64 \* 64 \* 3çš„å›¾åƒ (**3 ä»£è¡¨**:å› ä¸ºæ¯ä¸ªå›¾ç‰‡éƒ½æœ‰3ä¸ªé¢œè‰²é€šé“ channels, 12288 So $X$, **the input features has dimension 12288**)ï¼Œè€Œä¸€æ—¦å›¾åƒè´¨é‡å¢åŠ ï¼Œä¾‹å¦‚å˜æˆ 1000 \* 1000 \* 3 çš„æ—¶å€™é‚£ä¹ˆæ­¤æ—¶çš„ç¥ç»ç½‘ç»œçš„è®¡ç®—é‡ä¼šå·¨å¤§ï¼Œæ˜¾ç„¶è¿™ä¸ç°å®ã€‚æ‰€ä»¥éœ€è¦å¼•å…¥å…¶ä»–çš„æ–¹æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜.

## 2. Edge detection example

ä½¿ç”¨è¾¹ç¼˜æ£€æµ‹ä½œä¸ºå…¥é—¨æ ·ä¾‹, you see how the convolution operation works.

<img src="/images/deeplearning/C4W1-3_1.png" width="700" />

> è¾¹ç¼˜æ£€æµ‹å¯ä»¥æ˜¯å‚ç›´è¾¹ç¼˜æ£€æµ‹ï¼Œä¹Ÿå¯ä»¥æ˜¯æ°´å¹³è¾¹ç¼˜æ£€æµ‹ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤º.

è‡³äºç®—æ³•å¦‚ä½•å®ç°ï¼Œä¸‹é¢ä¸¾ä¸€ä¸ªæ¯”è¾ƒç›´è§‚çš„ä¾‹å­ï¼š

<img src="/images/deeplearning/C4W1-4_1.png" width="700" />

> å¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹å‡ºåŸæ¥ 6 \* 6 çš„çŸ©é˜µæœ‰æ˜æ˜¾çš„å‚ç›´è¾¹ç¼˜ï¼Œé€šè¿‡ 3 \* 3 çš„è¿‡æ»¤å™¨ **filter** (ä¹Ÿå«åš â€œæ ¸â€)å·ç§¯ä¹‹åï¼Œä»ç„¶ä¿ç•™äº†åŸæ¥çš„å‚ç›´è¾¹ç¼˜ç‰¹å¾ï¼Œè™½ç„¶è¿™ä¸ªè¾¹ç¼˜è²Œä¼¼æœ‰ç‚¹ç²—ï¼Œè¿™æ˜¯å› ä¸ºæ•°æ®ä¸å¤Ÿå¤§çš„åŸå› ï¼Œå¦‚æœè¾“å…¥æ•°æ®å¾ˆå¤§çš„è¯è¿™ä¸ªä¸æ˜¯å¾ˆæ˜æ˜¾äº†.
> 
> å…³äºç”¨ç¼–ç¨‹è¯­è¨€å®ç°ï¼špython / tensorflow / keras ç­‰ï¼Œéƒ½æœ‰ä¸€äº›å‡½æ•°æ¥å®ç°å·ç§¯è¿ç®—.

## 3. More edge detection

<img src="/images/deeplearning/C4W1-5_1.png" width="700" />

é™¤äº†ä¸Šé¢çš„å‚ç›´ï¼Œæ°´å¹³è¾¹ç¼˜æ£€æµ‹ï¼Œå…¶å®ä¹Ÿå¯ä»¥æ£€æµ‹åˆé¢œè‰²è¿‡åº¦å˜åŒ–ï¼Œä¾‹å¦‚æ˜¯äº®å˜æš—ï¼Œè¿˜æ˜¯æš—å˜äº®ï¼Ÿ

<img src="/images/deeplearning/C4W1-5_2.png" width="600" />

**åœ¨è®¡ç®—æœºè§†è§‰çš„å†å²ä¸Šï¼Œå±‚æ›¾ç»å…¬å¹³çš„äº‰è®ºè¿‡å“ªäº›ä»€ä¹ˆæ ·çš„ `filter` æ•°å­—ç»„åˆæ‰æ˜¯æœ€å¥½çš„:
**
> **ä¸‹é¢æ˜¯ä¸€äº›å¸¸è§çš„è¿‡æ»¤å™¨ï¼Œç¬¬äºŒä¸ªæ˜¯`Sobel filter`ï¼Œå…·æœ‰è¾ƒå¼ºçš„é²æ£’æ€§ï¼Œç¬¬ä¸‰ä¸ªæ˜¯`Schoss filter`.**

<img src="/images/deeplearning/C4W1-6_1.png" width="700" />

Filter | desc
:-------: | :-------:
Sobel Filter | it puts a little bit more weight to the central row <br> å¢åŠ äº†ä¸­é—´ä¸€è¡Œçš„æƒé‡
Schoss Filter | å®é™…å®ƒä¹Ÿæ˜¯ä¸€ç§å‚ç›´è¾¹ç¼˜æ£€æµ‹ <br> ç¿»è½¬90åº¦ï¼Œå®ƒå°±å˜ä¸ºæ°´å¹³è¾¹ç¼˜æ£€æµ‹ 
Other Filter | 9ä¸ªå‚æ•°ä¹Ÿå¯ä»¥é€šè¿‡å­¦ä¹ (åå‘ä¼ æ’­)çš„æ–¹å¼è·å¾— 

> å…¶å®è¿‡æ»¤å™¨çš„9ä¸ªå‚æ•°ä¹Ÿå¯ä»¥é€šè¿‡å­¦ä¹ (åå‘ä¼ æ’­)çš„æ–¹å¼è·å¾—ï¼Œè™½ç„¶æ¯”è¾ƒè´¹åŠ²ï¼Œä½†æ˜¯å¯èƒ½ä¼šå­¦åˆ°å¾ˆå¤šå…¶ä»–é™¤äº†å‚ç›´ï¼Œæ°´å¹³çš„è¾¹ç¼˜ç‰¹å¾ï¼Œä¾‹å¦‚  45Â°ï¼Œ70Â° ç­‰å„ç§ç‰¹å¾.

## 4. Padding

> **ç”±å‰é¢çš„ä¾‹å­, å·ç§¯çš„æ–¹æ³•ï¼Œæœ‰2ä¸ªç¼ºç‚¹:**
>
> 1. æ¯ç»è¿‡ä¸€æ¬¡å·ç§¯è®¡ç®—ï¼ŒåŸæ•°æ®éƒ½ä¼šå‡å°ï¼Œä½†æœ‰æ—¶æˆ‘ä»¬å¹¶ä¸å¸Œæœ›è¿™æ ·ã€‚ä¸¾ä¸ªæ¯”è¾ƒæç«¯çš„ä¾‹å­ï¼šå‡è®¾åŸæ•°æ®æ˜¯ 30 \* 30 çš„ä¸€åªçŒ«çš„å›¾åƒï¼Œç»è¿‡10æ¬¡å·ç§¯ (è¿‡æ»¤å™¨æ˜¯3 \* 3) åï¼Œæœ€åå›¾åƒåªå‰©ä¸‹äº† 10 \* 10 äº† ğŸ˜³ğŸ˜³
>
> 2. ç”±å·ç§¯çš„è®¡ç®—æ–¹æ³•å¯çŸ¥ï¼Œå›¾åƒè¾¹ç¼˜ç‰¹å¾è®¡ç®—æ¬¡æ•°æ˜¾ç„¶å°‘äºå›¾åƒä¸­é—´ä½ç½®çš„åƒç´ ç‚¹ï¼Œå¦‚ä¸‹å›¾ç¤º (ç»¿è‰²çš„ä½ç½®æ˜æ˜¾æ˜¯å†·å®«), å›¾åƒè¾¹ç¼˜çš„å¤§éƒ¨åˆ†ä¿¡æ¯éƒ½ä¸¢å¤±äº†.

### 4.1 è¿ç”¨ Padding çš„åŸå› 

<img src="/images/deeplearning/C4W1-7_1.png" width="500" />

åŸæ¥çš„ 6 \* 6 å¡«å……åå˜æˆäº† 8 \* 8ï¼Œæ­¤æ—¶åœ¨ç»è¿‡ä¸€æ¬¡å·ç§¯å¾—åˆ°çš„ä»æ—§æ˜¯ 6 \* 6 çš„çŸ©é˜µã€‚

ä¸‹é¢æ€»ç»“ä¸€ä¸‹å·ç§¯ä¹‹åå¾—åˆ°çŸ©é˜µå¤§å°çš„è®¡ç®—æ–¹æ³•ï¼Œå‡è®¾ï¼š

Title | Size | desc
:-------: | :-------: | :-------: 
åŸæ•°æ® | $n \* n$ | çŸ©é˜µ $n \* n$ 
Filter | $f \* f$ | è¿‡æ»¤å™¨
Padding | $p \* p$ | å¡«å……æ•°é‡
| |
**ç»¼ä¸Šï¼š** | **$n+2p-f+1$** | å¾—åˆ°çš„çŸ©é˜µå¤§å°

> padding åï¼Œè™½ç„¶è¾¹ç¼˜åƒç´ ç‚¹ä»æ—§è®¡ç®—çš„æ¯”è¾ƒå°‘ï¼Œä½†æ˜¯è¿™ä¸ªç¼ºç‚¹è‡³å°‘ä¸€å®šç¨‹åº¦ä¸Šè¢«å‰Šå¼±äº†.

### 4.2 å¦‚ä½• padding çš„å¤§å°

Type | desc | Size
:-------: | :-------: | :-------: 
Valid convolutions | ä¸æ·»åŠ  padding | $n - f + 1$
Same convolutions | Pad so that output size is the same as the input size. <br><br> ä¿æŒåŸå›¾åƒçŸ©é˜µçš„å¤§å° | æ»¡è¶³ $n+2p-f+1 = n$ <br><br> å³ $p=\frac{f-1}{2}$, ä¸ºäº†æ»¡è¶³ä¸Šå¼ï¼Œ$f$ ä¸€èˆ¬å¥‡æ•°

## 5. Strided convolutions

è¿‡æ»¤å™¨ çºµå‘ã€æ¨ªå‘ éƒ½éœ€è¦æŒ‰ æ­¥é•¿ $S$ æ¥ç§»åŠ¨ï¼Œå¦‚å›¾ç¤º:

<img src="/images/deeplearning/C4W1-8_1.png" width="700" />

ç»“åˆä¹‹å‰çš„å†…å®¹ï¼Œè¾“å‡ºçŸ©é˜µå¤§å°è®¡ç®—å…¬å¼æ–¹æ³•ä¸ºï¼Œå‡è®¾ï¼š

Title | Size | desc
:-------: | :-------: | :-------: 
åŸæ•°æ® | $n \* n$ | çŸ©é˜µ $n \* n$ 
Filter | $f \* f$ | è¿‡æ»¤å™¨
Padding | $p \* p$ | å¡«å……æ•°é‡
Stride | $s \* s$ | æ­¥é•¿
| |
**ç»¼ä¸Šï¼š** | å¾—åˆ°çš„çŸ©é˜µå¤§å°æ˜¯ | **âŒŠ$\frac{n+2p-f}{s}$âŒ‹ \* âŒŠ$\frac{n+2p-f}{s}$âŒ‹**

> âŒŠâŒ‹: å‘ä¸‹å–æ•´ç¬¦å· âŒŠ59/60âŒ‹ = 0
>
> âŒˆâŒ‰: å‘ä¸Šå–æ•´ç¬¦å· âŒˆ59/60âŒ‰ = 1

## 6. Convolutions Over Volumes

è¿™ä¸€èŠ‚ç”¨ç«‹ä½“å·ç§¯æ¥è§£é‡Š

<img src="/images/deeplearning/C4W1-9_1.png" width="700" />

> **å¦‚å›¾**:
>
> - è¾“å…¥çŸ©é˜µæ˜¯ $6 \* 6 \* 3$ (height \* width \* channels), è¿‡æ»¤å™¨æ˜¯ $3 \* 3 \* 3$ï¼Œè®¡ç®—æ–¹æ³•æ˜¯ä¸€ä¸€å¯¹åº”ç›¸ä¹˜ç›¸åŠ 
> - æœ€åå¾—åˆ° $4 \* 4$ çš„äºŒç»´çŸ©é˜µ.
>
> æœ‰æ—¶å¯èƒ½éœ€è¦æ£€æµ‹ æ°´å¹³è¾¹ç¼˜ æˆ– å‚ç›´è¾¹ç¼˜ï¼Œæˆ– å…¶ä»–ç‰¹å¾ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ªè¿‡æ»¤å™¨ã€‚ä¸Šå›¾åˆ™ä½¿ç”¨äº†ä¸¤ä¸ªè¿‡æ»¤å™¨ (é»„è‰²å’Œæ©˜é»„è‰²)ï¼Œå¾—åˆ°çš„ç‰¹å¾çŸ©é˜µå¤§å°ä¸º $4 \* 4 \* 2$.
> 
> **Filter** æ•°å­—ç»„åˆå‚æ•°çš„é€‰æ‹©ä¸åŒï¼Œä½ å¯ä»¥å¾—åˆ°ä¸åŒçš„ç‰¹å¾æ£€æµ‹å™¨.

## 7. One Layer A Convolutional Network

<img src="/images/deeplearning/C4W1-10_1.png" width="700" />

å¦‚å›¾ç¤ºå¾—åˆ° **$4 \* 4$** çš„çŸ©é˜µåè¿˜éœ€è¦åŠ ä¸Šä¸€ä¸ªåå·® **$b\_n$** (Python å¹¿æ’­æœºåˆ¶)ï¼Œä¹‹åè¿˜è¦è¿›è¡Œéçº¿æ€§è½¬æ¢ï¼Œå³ç”¨ ReLU å‡½æ•°.

<img src="/images/deeplearning/C4W1-10_2.png" width="700" />

å› æ­¤å‡å¦‚åœ¨æŸä¸€å·ç§¯å±‚ä¸­ä½¿ç”¨äº† 10 ä¸ª **$3 \* 3$** çš„ **Filter** è¿‡æ»¤å™¨ï¼Œé‚£ä¹ˆä¸€å…±æœ‰ $(3\*3+1)\*10=280$ ä¸ªå‚æ•°.

<img src="/images/deeplearning/C4W1-11_1.png" width="700" />

ä¸‹é¢æ€»ç»“äº†å„é¡¹å‚æ•°çš„å¤§å°å’Œè¡¨ç¤ºæ–¹æ³•ï¼š

Title | Formula | desc 
:-------:  | :-------: | :-------: 
**è¾“å…¥çŸ©é˜µ** | $n\_H^{l-1} \* n\_W^{l-1} \* n\_c^{l-1}$ | $height \* width \* channels = 6 \* 6 \* 3$
è¿‡æ»¤å™¨å¤§å° | $f^{[l]}$ |
Padding | $p^{[l]}$ |
Stride | $s^l$ | æ­¥é•¿
Each Filter is | $f^{l} \* f^{l} \* n\_c^{[l-1]}$ | $3 \* 3 \* 3$  ,  $n\_c^{[l-1]} = 3$ <br><br> æ¯ä¸€å·ç§¯å±‚çš„è¿‡æ»¤å™¨çš„é€šé“çš„å¤§å° = è¾“å…¥å±‚çš„é€šé“å¤§å° $n\_c^{[l-1]}$
Activations æ¿€æ´»å‡½æ•° | $a^{l}$ = $n\_H^{l} \* n\_W^{l} \* n\_c^{l}$ | $A^{l}$ = $m \* n\_H^{l} \* n\_W^{l} \* n\_c^{l}$ï¼Œ($m$ä¸ªä¾‹å­)
æƒé‡ weight | $f^{l} \* f^{l} \* n\_c^{[l-1]} \* n\_c^{[l]}$ | $Filter \* è¿‡æ»¤å™¨ä¸ªæ•°$ <br><br> è¿‡æ»¤å™¨çš„ä¸ªæ•° = è¾“å‡ºå±‚çš„é€šé“çš„å¤§å° $n\_c^{l}$
åå·® bias | $1 \* 1 \* 1 \* n\_c^{[l]}$ |
| |
**è¾“å‡ºçŸ©é˜µ** | $n\_H^{l} \* n\_W^{l} \* n\_c^{l}$ | $height \* width \* channels$
Output | $n\_{H/W}^{[l]}=[\frac{n\_{H/W}^{[l-1]}+2p^{[l]}-f^{[l]}}{s^{[l]}}+1]$ | è¾“å‡ºå±‚ä¸è¾“å…¥å±‚è®¡ç®—å…¬å¼

## 8. A Simple Convolution Network

<img src="/images/deeplearning/C4W1-12_1.png" width="750" />

ä¸Šå›¾ç®€å•ä»‹ç»äº†å·ç§¯ç½‘ç»œçš„è®¡ç®—è¿‡ç¨‹ï¼Œéœ€è¦å†ä»‹ç»çš„ä¸€ç‚¹æ˜¯æœ€åä¸€å±‚çš„å…¨è¿æ¥å±‚ï¼Œå³å°† $7 \* 7 \* 40$ çš„è¾“å‡ºçŸ©é˜µå±•å¼€ï¼Œå¾—åˆ° $1960$ ä¸ªèŠ‚ç‚¹ï¼Œç„¶åå†é‡‡ç”¨ **Softmax** æ¥è¿›è¡Œé¢„æµ‹.

> ä¸€èˆ¬çš„ **CNN** ä¸­ï¼Œæ¯ä¸€å±‚çŸ©é˜µçš„ **height** å’Œ **width** æ˜¯é€æ¸å‡å°çš„ï¼Œè€Œ **channel** åˆ™æ˜¯å¢åŠ çš„ ($n\_c$ åœ¨å¢åŠ ï¼Œ$n\_H$ å’Œ $n\_W$ åœ¨å‡å°‘).

**CNN ä¸­å¸¸è§çš„ 3 ç§ç±»å‹çš„ layerï¼š**

1. Convolution (Conv å·ç§¯å±‚)
2. Pooling (Pool æ± åŒ–å±‚)
3. Fully connected (FC å…¨è¿æ¥å±‚)

## 9. Pooling Layers

ä½¿ç”¨æ± åŒ–å±‚æ¥ç¼©å‡æ¨¡å‹çš„å¤§å°ï¼Œæé«˜è®¡ç®—é€Ÿåº¦ï¼ŒåŒæ—¶æé«˜æå–ç‰¹å¾çš„é²æ£’æ€§.

<img src="/images/deeplearning/C4W1-13_1.png" width="700" />

**<font color="wathet">æœ€å¤§æ± åŒ–çš„ç›´è§‚ç†è§£</font>:**

ä½ å¯ä»¥æŠŠä¸Šé¢ $4 \* 4$ è¾“å…¥çœ‹åšæ˜¯æŸäº›ç‰¹å¾çš„é›†åˆ (ä¹Ÿè®¸ä¸æ˜¯)ï¼Œä¹Ÿå°±æ˜¯ç¥ç»ç½‘ç»œä¸­æŸä¸€å±‚çš„åæ¿€æ´»å€¼ï¼Œæ•°å­—å¤§æ„å‘³ç€å¯èƒ½æå–äº†æŸäº›ç‰¹å®šç‰¹å¾. å·¦ä¸Šè±¡é™å…·æœ‰è¿™ä¸ªç‰¹å¾ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªå‚ç›´è¾¹ç¼˜. or maybe an eyeï¼Œ æ˜¾ç„¶å·¦ä¸Šè±¡é™å…·æœ‰è¿™ä¸ªç‰¹å¾.

æœ€å¤§åŒ–æ“ä½œçš„åŠŸèƒ½å°±æ˜¯åªè¦åœ¨ä»»ä½•ä¸€ä¸ªè±¡é™å†…æå–åˆ°æŸä¸ªç‰¹å¾ï¼Œå®ƒå°±ä¼šä¿ç•™åœ¨æœ€å¤§æ± åŒ–çš„è¾“å‡ºé‡Œ. æœ€å¤§åŒ–æ“ä½œçš„å®é™…ä½œç”¨å°±æ˜¯ï¼šå¦‚æœåœ¨ **Filter** ä¸­æå–åˆ°æŸä¸ªç‰¹å¾ é‚£ä¹ˆä¿ç•™å…¶æœ€å¤§å€¼. å¦‚æœæ²¡æœ‰æå–åˆ°è¿™ä¸ªç‰¹å¾ï¼Œæ¯”å¦‚è¯´ å³ä¸Šè±¡é™ ä¸­ï¼Œé‚£ä¹ˆå…¶æœ€å¤§å€¼ä¹Ÿè¿˜æ˜¯å¾ˆå°. 

> `Max Pooling` çš„è¶…çº§å‚æ•° $f=2 / 3$ï¼Œ$s=2$ æ˜¯æœ€å¸¸ç”¨çš„ï¼Œæ•ˆæœç›¸å½“äºé«˜åº¦å’Œå®½åº¦ç¼©å‡ä¸€åŠ. `Max Pooling` å¾ˆå°‘ç”¨ paddingï¼Œ by far, is $p = 0$ï¼ŒAverage Pooling è¿™ä¸ªç”¨çš„ä¸å¤šï¼Œè¿™ä¸ªä¹Ÿä¼šåŠ å…¥æ›´å¤šçš„è®¡ç®—é‡.

## 10. Convolutional neural network example

æ± åŒ–å±‚æ²¡æœ‰æƒé‡å’Œå‚æ•°ï¼Œæ‰€ä»¥ä¸åšå±‚æ•°çš„ç»Ÿè®¡.

## 11. Why Convolutions ?

## Reference

- [ç½‘æ˜“äº‘è¯¾å ‚ - deeplearning][1]
- [DeepLearning.aiå­¦ä¹ ç¬”è®°æ±‡æ€»][2]
- [CNNå…¥é—¨è®²è§£ï¼šå·ç§¯å±‚æ˜¯å¦‚ä½•æå–ç‰¹å¾çš„ï¼Ÿ][3]

[1]: https://study.163.com/my#/smarts
[2]: http://www.cnblogs.com/marsggbo/p/7470989.html
[3]: https://zhuanlan.zhihu.com/p/31657315
