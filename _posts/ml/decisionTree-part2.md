---
title: Decision Tree part2
date: 2018-06-27 16:43:21
categories: machine-learning
tags: [decision-tree]
---

<img src="/images/ml/decision-tree/decision-tree-2.png" width="330" /img>

<!-- more -->

## 1. å†³ç­–æ ‘æ¨¡å‹

å†³ç­–æ ‘ï¼ˆdecision treeï¼‰æ˜¯ä¸€ä¸ªæ ‘ç»“æ„ï¼ˆå¯ä»¥æ˜¯äºŒå‰æ ‘æˆ–éäºŒå‰æ ‘ï¼‰

> å…³äº ID3 ä¸ C4.5 çš„å…·ä½“è®¡ç®—æµç¨‹ç¤ºä¾‹ï¼Œè¯·å‚è§ [desicion tree (part1)][part1]

### 1.1. å®šä¹‰

åˆ†ç±»å†³ç­–æ ‘æ¨¡å‹æ˜¯ä¸€ç§æè¿°å¯¹å®ä¾‹è¿›è¡Œåˆ†ç±»çš„æ ‘å½¢ç»“æ„ï¼Œå…¶ä¸­åŒ…å«ä¸¤ç§ç±»å‹çš„èŠ‚ç‚¹

 1. å†…éƒ¨èŠ‚ç‚¹: è¡¨ç¤ºä¸€ä¸ª featureï¼ˆå±æ€§ï¼‰
 2. å¶èŠ‚ç‚¹: è¡¨ç¤ºä¸€ä¸ª class

> ä¸€èˆ¬å†³ç­–æ ‘å¯ä»¥æ ¹æ®ä»¥ä¸‹å››ä¸ªæ–¹é¢åˆ’åˆ†å½’ç±» :
>  1. åˆ†æ”¯æ•°
>  2. åˆ’åˆ†ç­–ç•¥
>  3. ç»ˆæ­¢ç­–ç•¥
>  4. åŸºåˆ†ç±»å™¨

### 1.2. if-thenè§„åˆ™é›†åˆ

> 1. ä¸€æ¡ç”±æ ¹èŠ‚ç‚¹åˆ°å¶èŠ‚ç‚¹çš„è·¯å¾„ â€“> **ä¸€æ¡è§„åˆ™**
> 2. è·¯å¾„ä¸Šå†…éƒ¨èŠ‚ç‚¹çš„ç‰¹å¾ â€“> è§„åˆ™çš„æ¡ä»¶
> 3. å¶èŠ‚ç‚¹çš„ç±» â€“> è§„åˆ™çš„ç»“è®º class
> 4. æ€§è´¨ï¼šäº’æ–¥ä¸”å®Œå¤‡

### 1.3. æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ

> ç»™å®š feature æ¡ä»¶ä¸‹ class çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ

## 2. å†³ç­–æ ‘çš„å­¦ä¹ 

å†³ç­–æ ‘å­¦ä¹ æœ¬è´¨æ˜¯ä» train datasets ä¸­å½’çº³å‡ºä¸€ç»„åˆ†ç±»è§„åˆ™ï¼Œå¦ä¸€ä¸ªè§’åº¦ï¼Œå­¦ä¹ æ˜¯ç”± train datasets ä¼°è®¡æ¡ä»¶æ¦‚ç‡æ¨¡å‹

### 2.1 ç›®çš„

> å¾—åˆ°ä¸€ä¸ªä¸è®­ç»ƒæ•°æ®çŸ›ç›¾è¾ƒå°çš„å†³ç­–æ ‘ï¼ŒåŒæ—¶å…·æœ‰å¾ˆå¥½çš„æ³›åŒ–èƒ½åŠ›

### 2.2 ç­–ç•¥

> ä»¥æŸå¤±å‡½æ•°ï¼ˆé€šå¸¸ä¸ºæ­£åˆ™åŒ–çš„æå¤§ä¼¼ç„¶å‡½æ•°ï¼‰ä¸ºç›®æ ‡å‡½æ•°çš„æœ€å°åŒ–ï¼Œå¹¶åœ¨æŸå¤±å‡½æ•°ç¡®å®šåï¼Œé€‰æ‹©æœ€ä¼˜å†³ç­–æ ‘

### 2.3 å­¦ä¹ ç®—æ³•

>  1. ç†è®ºä¸Šï¼š~~ä»æ‰€æœ‰å¯èƒ½çš„å†³ç­–æ ‘ä¸­é€‰å–æœ€ä¼˜å†³ç­–æ ‘ï¼ŒNPå®Œå…¨é—®é¢˜~~
>  2. å®é™…ä¸­ï¼šé‡‡ç”¨å¯å‘å¼æ–¹æ³•ï¼Œè¿‘ä¼¼æ±‚è§£ï¼ˆå¾—åˆ°æ¬¡æœ€ä¼˜å†³ç­–æ ‘ï¼‰â€“> é€’å½’çš„é€‰æ‹©æœ€ä¼˜ç‰¹å¾ï¼Œå¹¶æ ¹æ®è¯¥æœ€ä¼˜ç‰¹å¾å¯¹è®­ç»ƒæ•°æ®è¿›è¡Œåˆ†å‰²ï¼Œä½¿å¾—å¯¹å„ä¸ªå­æ•°æ®é›†æœ‰ä¸€ä¸ªæœ€å¥½çš„åˆ†ç±»çš„è¿‡ç¨‹ã€‚
>  3. ä¸»è¦æ­¥éª¤ï¼š (1). ç‰¹å¾é€‰æ‹© (2). å†³ç­–æ ‘çš„ç”Ÿæˆ (3). å†³ç­–æ ‘çš„å‰ªæ

Notes: å†³ç­–æ ‘çš„ç”Ÿæˆå¯¹åº”äºæ¨¡å‹çš„å±€éƒ¨é€‰æ‹©ï¼Œå†³ç­–æ ‘çš„å‰ªæå¯¹åº”äºæ¨¡å‹çš„å…¨å±€é€‰æ‹©ã€‚

## 3. ç‰¹å¾é€‰æ‹©

- å®è´¨ ï¼š é€‰å–å¯¹äºè®­ç»ƒæ•°æ®å…·æœ‰åˆ†ç±»èƒ½åŠ›çš„ç‰¹å¾ï¼ˆå†³å®šç”¨å“ªä¸ª **feature** æ¥åˆ’åˆ† **feature space**ï¼‰

- å¸¸ç”¨å‡†åˆ™

> Algorithm | Feature é€‰æ‹©æ–¹æ³• | Author
> :-------: | :-------: | :-------:
> ID3 | Information gain | Quinlan. 1986
> C4.5 | Gain ratio | Quinlan. 1993.
CART | å›å½’æ ‘ï¼š æœ€å°äºŒä¹˜<br>åˆ†ç±»æ ‘ï¼š åŸºå°¼æŒ‡æ•° Gini index | Breiman. 1984<br>(Classification and Regression Tree åˆ†ç±»ä¸å›å½’æ ‘)

### 3.1 ä¿¡æ¯å¢ç›Š Information gain

$$
g(D, A)=H(D)-H(D|A)
$$

> $g(D, A)$å³ä¿¡æ¯å¢ç›Šï¼Œè¡¨ç¤ºå¾—çŸ¥ç‰¹å¾$A$çš„ä¿¡æ¯è€Œä½¿å¾—ç±»$D$çš„ä¿¡æ¯çš„ä¸ç¡®å®šæ€§å‡å°‘çš„ç¨‹åº¦
> 
> $H(D)$ ä¸ºé›†åˆ $D$ çš„ä¿¡æ¯ç†µ

> - å…¶ä¸­å‡è®¾ $D$ æ˜¯ä¸€ä¸ªå–æœ‰é™ä¸ªå€¼çš„ç¦»æ•£éšæœºå˜é‡ï¼Œæ¦‚ç‡åˆ†å¸ƒä¸º $P(X=x_i)=p_i, i=1, 2,â€¦,n$
> 
> - ç†µæ˜¯è¡¨ç¤ºéšæœºå˜é‡ä¸ç¡®å®šæ€§çš„åº¦é‡ï¼Œå®šä¹‰ $H(D)=- \sum_{i=1}^n p_ilogp_i$ï¼Œç†µè¶Šå¤§ï¼Œéšæœºå˜é‡çš„ä¸ç¡®å®šæ€§å°±è¶Šå¤§ï¼Œ$0 \leq H(D) \leq logn$
> - $H(D|A)$ ç»éªŒæ¡ä»¶ç†µåœ¨å·²çŸ¥éšæœºå˜é‡$A$ï¼ˆç‰¹å¾ï¼‰çš„æ¡ä»¶ä¸‹éšæœºå˜é‡ $D$ çš„ä¸ç¡®å®šæ€§$H(D|A)= \sum_{i=1}^{n}p_iH(D|A=a_i)$
> 
> - ä¸€èˆ¬å°†ç†µ $H(D)$ ä¸æ¡ä»¶ç†µ $H(D|A)$ ä¹‹å·®ç§°ä¸ºäº’ä¿¡æ¯ï¼Œå†³ç­–æ ‘å­¦ä¹ ä¸­çš„ä¿¡æ¯å¢ç›Šç­‰ä»·äºç±»ä¸ç‰¹å¾çš„äº’ä¿¡æ¯

**å°ç»“:**

> - ç»™å®šè®­ç»ƒæ•°æ®é›† $D$ å’Œç‰¹å¾ $A$ï¼Œç»éªŒç†µ $H(D)$ è¡¨ç¤ºå¯¹æ•°æ®é›† $D$ è¿›è¡Œåˆ†ç±»çš„ä¸ç¡®å®šæ€§ï¼Œè€Œç»éªŒæ¡ä»¶ç†µ $H(D|A)$ è¡¨ç¤ºåœ¨ç‰¹å¾ $A$ ç»™å®šçš„æ¡ä»¶ä¸‹å¯¹æ•°æ®é›†è¿›è¡Œåˆ†ç±»çš„ä¸ç¡®å®šæ€§ï¼Œå› æ­¤ä¸¤è€…ä¹‹å·®å³`ä¿¡æ¯å¢ç›Š`è¡¨ç¤ºç”±äºç‰¹å¾ $A$ è€Œä½¿å¾—æ•°æ®é›† $D$ çš„åˆ†ç±»çš„ä¸ç¡®å®šæ€§å‡å°‘çš„ç¨‹åº¦.

> - å¯¹äºæ•°æ®é›† $D$ è€Œè¨€ï¼Œä¿¡æ¯å¢ç›Šä¾èµ–äºç‰¹å¾ï¼Œ`ä¸åŒç‰¹å¾å…·æœ‰ä¸åŒçš„ä¿¡æ¯å¢ç›Šï¼Œä¿¡æ¯å¢ç›Šå¤§çš„ç‰¹å¾å…·æœ‰æ›´å¼ºçš„åˆ†ç±»èƒ½åŠ›`ï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦æŒ‘é€‰çš„ç›®æ ‡ï¼‰

### 3.2 ä¿¡æ¯å¢ç›Šæ¯” Gain ratio

> ä»¥ä¿¡æ¯å¢ç›Šä½œä¸ºåˆ’åˆ†è®­ç»ƒæ•°æ®é›†çš„ç‰¹å¾ï¼Œå­˜åœ¨åå‘äº**é€‰æ‹©å–å€¼è¾ƒå¤š**çš„ç‰¹å¾çš„é—®é¢˜ï¼Œä½¿ç”¨ä¿¡æ¯å¢ç›Šæ¯”å¯ä»¥å¯¹è¿™é—®é¢˜è¿›è¡Œæ ¡æ­£.

ç‰¹å¾$A$å¯¹è®­ç»ƒæ•°æ®é›†$D$çš„ä¿¡æ¯å¢ç›Šæ¯”$g_R(D,A)$å®šä¹‰ä¸ºå…¶ä¿¡æ¯å¢ç›Š$g(D,A)$ä¸è®­ç»ƒæ•°æ®é›†$D$å…³äºç‰¹å¾$A$çš„å€¼çš„ç†µ$H_A(D)$ä¹‹æ¯”ï¼š

$$
g_R(D,A)= \frac{g(D,A)}{H_A(D)}
$$

å…¶ä¸­

$$
H\_A(D)=- \sum\_{i=1}^{n} \frac{|D\_{i}|}{|D|}log\_2 \frac{|D\_{i}|}{|D|}
$$

> $n$ ä¸ºç‰¹å¾ $A$ çš„å–å€¼ä¸ªæ•°ï¼Œ$D_i$ è¡¨ç¤ºæ®ç‰¹å¾ $A$ çš„å–å€¼å°† $D$ åˆ†æˆçš„å­é›†

## 4. å†³ç­–æ ‘çš„ç”Ÿæˆ

### 4.1 ID3

**æ ¸å¿ƒæ€æƒ³:**

> - åœ¨å†³ç­–æ ‘çš„å„ä¸ªç»“ç‚¹ä¸Šåº”ç”¨ä¿¡æ¯å¢ç›Šå‡†åˆ™é€‰æ‹©ç‰¹å¾ï¼Œé€’å½’åœ°æ„å»ºå†³ç­–æ ‘ã€‚
> - é€’å½’ç»ˆæ­¢æ¡ä»¶ï¼šæ‰€æœ‰ç‰¹å¾çš„ä¿¡æ¯å¢ç›Šï¼ˆè®¾ç½®ä¿¡æ¯å¢ç›Šçš„é˜ˆå€¼æ¥åˆ¤æ–­æ˜¯å¦è¿›ä¸€æ­¥åˆ’åˆ†ï¼‰å‡å¾ˆå°æˆ–æ²¡ç‰¹å¾å¯é€‰ä¸ºæ­¢.
> 
> ï¼ˆæ¯é€‰ä¸€ä¸ª`ç‰¹å¾`åˆ™åæœŸåˆ’åˆ†å­æ ‘ä¸å†ä½¿ç”¨å‰é¢ç”¨è¿‡çš„`ç‰¹å¾`ï¼Œå› ä¸ºå­æ ‘å·²ç»æ˜¯åœ¨è¯¥ç‰¹å¾ä¸‹å±äºåŒä¸€å–å€¼çš„å®ä¾‹é›†åˆï¼‰

**å†³ç­–æ ‘çš„ç”Ÿæˆ:**

> è¾“å…¥ï¼šè®­ç»ƒæ•°æ®é›† $D$ å’Œç‰¹å¾é›† $A$ï¼Œé˜ˆå€¼ $Îµ$ï¼›
> è¾“å‡ºï¼šå†³ç­–æ ‘ $T$
> 
>  (1) ï¼ˆå¶å­ç»“ç‚¹ï¼‰è‹¥ $D$ ä¸­æ‰€æœ‰å®ä¾‹å±äºåŒä¸€ç±» $C\_k$, åˆ™ $T$ ä¸ºå•èŠ‚ç‚¹æ ‘ï¼Œå¹¶å°†ç±»$C\_k$ ä½œä¸ºè¯¥ç»“ç‚¹çš„ç±»æ ‡è®°ï¼Œè¿”å› $T$
>  (2) ï¼ˆç»ˆæ­¢æ¡ä»¶ä¹‹æ²¡æœ‰ç‰¹å¾å¯ä¾›é€‰æ‹©ï¼‰ è‹¥ $A=âˆ…$, åˆ™ $T$ä¸ºå•èŠ‚ç‚¹æ ‘ï¼Œå¹¶å°† $D$ ä¸­å®ä¾‹æ•°æœ€å¤§çš„ç±» $C\_k$ ä½œä¸ºè¯¥ç»“ç‚¹çš„ class æ ‡è®°ï¼ˆå¤šæ•°è¡¨å†³è§„åˆ™ï¼‰ï¼Œè¿”å› $T$
> 
>  (3) ï¼ˆè®¡ç®— $A$ ä¸­å„ç‰¹å¾å¯¹ $D$ çš„**ä¿¡æ¯å¢ç›Š**ï¼Œé€‰æ‹©ä¿¡æ¯å¢ç›Šæœ€å¤§çš„ç‰¹å¾ $A\_g$
>  (4) ï¼ˆç»ˆæ­¢æ¡ä»¶ä¹‹é˜ˆå€¼) è‹¥ $A\_g$ çš„ä¿¡æ¯å¢ç›Šå°äºé˜ˆå€¼ $Îµ$ï¼Œåˆ™ç½® $T$ ä¸ºå•èŠ‚ç‚¹æ ‘ï¼Œå¹¶å°† $D$ ä¸­å®ä¾‹æ•°æœ€å¤§çš„ç±» $C\_k$ ä½œä¸ºè¯¥ç»“ç‚¹çš„ç±»æ ‡è®°ï¼Œè¿”å› $T$
> 
> (5) å¦åˆ™ï¼Œå¯¹ $A\_g$ çš„æ¯ä¸€å¯èƒ½å€¼ $a\_i$ï¼Œä¾ $A\_g=a\_i$ å°† $D$ åˆ’åˆ†ä¸ºè‹¥å¹²éç©ºå­é›† $D\_i$ï¼Œå¹¶å°† $D\_i$ ä¸­å®ä¾‹æ•°æœ€å¤§çš„ç±»ä½œä¸ºæ ‡è®°æ„å»ºå­èŠ‚ç‚¹ï¼Œè¿”å› $T\_i$
(6) å¯¹ç¬¬ $i$ ä¸ªå­èŠ‚ç‚¹ï¼Œä»¥ $D\_i$ ä¸ºè®­ç»ƒé›†ï¼Œ$A âˆ’ {A\_g}$ ä¸ºç‰¹å¾é›†ï¼Œé€’å½’åœ°è°ƒç”¨(1)~(5)å¾—åˆ°å­æ ‘ $T\_i$ å¹¶è¿”å›.

### 4.2 C4.5

C4.5ç®—æ³•ä¸ID3ç®—æ³•ç±»ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºï¼ŒC4.5åœ¨ç”Ÿæˆçš„è¿‡ç¨‹ä¸­ï¼Œç”¨`Gain ratio`æ¥é€‰æ‹©ç‰¹å¾ã€‚

> Notes: ä¸Šè¿°å†³ç­–æ ‘çš„ç”Ÿæˆç®—æ³•åªæœ‰æ ‘çš„ç”Ÿæˆï¼Œè€Œä¸”æ˜¯é’ˆå¯¹è®­ç»ƒé›†æ„é€ çš„æ ‘ï¼Œå®¹æ˜“äº§ç”Ÿè¿‡æ‹Ÿåˆã€‚

## 5. CART(classification and regression tree)

- CART å‡è®¾å†³ç­–æ ‘æ˜¯äºŒå‰æ ‘ï¼Œè€Œ ID3,C4.5 ç”Ÿæˆçš„è¿‡ç¨‹ä¸­å¹¶æ— æ­¤å‡è®¾ï¼Œè¿™ä¹Ÿå¯¼è‡´äº†ä¸¤è€…çš„æ ¹æœ¬ä¸åŒï¼ŒID3,C4.5 æ¯æ¬¡é€‰æ‹©å‡ºæœ€ä½³ç‰¹å¾ä¹‹åï¼Œæ˜¯æŒ‰ç…§è¯¥ç‰¹å¾çš„æ¯ä¸€ä¸ªå–å€¼åˆ’åˆ†å­æ ‘ï¼›
- CART åˆ™æ˜¯å¯¹æ¯ä¸€ä¸ªç‰¹å¾ã€æ¯ä¸€ä¸ªç‰¹å¾çš„æ¯ä¸€ä¸ªå–å€¼è®¡ç®—åŸºå°¼æŒ‡æ•°ï¼ˆåˆ†ç±»æ ‘ï¼‰ç„¶åä»æ‰€æœ‰ç‰¹å¾å¯¹åº”çš„å–å€¼è®¡ç®—æ‰€å¾—çš„åŸºå°¼æŒ‡æ•°ä¸­æœ€å°çš„ç‰¹å¾åŠç‰¹å¾å€¼ä½œä¸º`åˆ‡åˆ†ç‚¹`æ¥åˆ’åˆ†å­æ ‘ï¼Œå¹¶åœ¨è¿™äº›å­ç©ºé—´ä¸Šç¡®å®šé¢„æµ‹çš„æ¦‚ç‡åˆ†å¸ƒï¼Œä¹Ÿå°±æ˜¯åœ¨è¾“å…¥ç»™å®šçš„æ¡ä»¶ä¸‹è¾“å‡ºå¯¹åº”çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ.

### 5.1 CART çº¯åº¦åº¦é‡

CART ä¸­ç”¨äºé€‰æ‹©å˜é‡çš„ä¸çº¯æ€§åº¦é‡æ˜¯ **Gini index**ï¼›å¦‚æœç›®æ ‡å˜é‡æ˜¯æ ‡ç§°çš„ï¼Œå¹¶ä¸”æ˜¯å…·æœ‰ä¸¤ä¸ªä»¥ä¸Šçš„ç±»åˆ«ï¼Œåˆ™ CART å¯èƒ½è€ƒè™‘å°†ç›®æ ‡ç±»åˆ«åˆå¹¶æˆä¸¤ä¸ªè¶…ç±»åˆ«ï¼ˆåŒåŒ–ï¼‰ï¼›å¦‚æœç›®æ ‡å˜é‡æ˜¯è¿ç»­çš„ï¼Œåˆ™ CART æ‰¾å‡ºä¸€ç»„åŸºäºæ ‘çš„å›å½’æ–¹ç¨‹æ¥é¢„æµ‹ç›®æ ‡å˜é‡ã€‚

Algorithm | Feature Selection | Author
:-------: | :-------: | :-------:
CART | å›å½’æ ‘ï¼š æœ€å°äºŒä¹˜<br>åˆ†ç±»æ ‘ï¼š åŸºå°¼æŒ‡æ•° Gini index | Breiman. 1984<br>(Classification and Regression Tree åˆ†ç±»ä¸å›å½’æ ‘)

### 5.2 CART æ­¥éª¤

`build decision tree`æ—¶é€šå¸¸é‡‡ç”¨è‡ªä¸Šè€Œä¸‹çš„æ–¹æ³•ï¼Œåœ¨æ¯ä¸€æ­¥é€‰æ‹©ä¸€ä¸ªæœ€å¥½çš„å±æ€§æ¥åˆ†è£‚ã€‚ "æœ€å¥½" çš„å®šä¹‰æ˜¯ä½¿å¾—å­èŠ‚ç‚¹ä¸­çš„è®­ç»ƒé›†å°½é‡çš„çº¯ã€‚ä¸åŒçš„ç®—æ³•ä½¿ç”¨ä¸åŒçš„æŒ‡æ ‡æ¥å®šä¹‰"æœ€å¥½"ã€‚

**CART** æ˜¯åœ¨ç»™å®šè¾“å…¥éšæœºå˜é‡ $X$ æ¡ä»¶ä¸‹æ±‚å¾—è¾“å‡ºéšæœºå˜é‡ $Y$ çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒçš„å­¦ä¹ æ–¹æ³•ã€‚

> å¯ä»¥çœ‹å‡ºCARTç®—æ³•åœ¨å¶èŠ‚ç‚¹è¡¨ç¤ºä¸Šä¸åŒäºID3ã€C4.5æ–¹æ³•ï¼ŒåäºŒè€…å¶èŠ‚ç‚¹å¯¹åº”æ•°æ®å­é›†é€šè¿‡â€œå¤šæ•°è¡¨å†³â€çš„æ–¹å¼æ¥ç¡®å®šä¸€ä¸ªç±»åˆ«ï¼ˆå›ºå®šä¸€ä¸ªå€¼ï¼‰ï¼›è€ŒCARTç®—æ³•çš„å¶èŠ‚ç‚¹å¯¹åº”ç±»åˆ«çš„æ¦‚ç‡åˆ†å¸ƒã€‚å¦‚æ­¤çœ‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°ç”¨ CART æ¥å­¦ä¹ ä¸€ä¸ª `multi-label` çš„åˆ†ç±»ä»»åŠ¡ã€‚

**CART** ç®—æ³•ä¹Ÿä¸»è¦ç”±ä¸¤æ­¥ç»„æˆ:

- å†³ç­–æ ‘çš„ç”Ÿæˆï¼šåŸºäºè®­ç»ƒæ•°æ®é›†ç”Ÿæˆä¸€æ£µäºŒåˆ†å†³ç­–æ ‘ï¼›
- å†³ç­–æ ‘çš„å‰ªæï¼šç”¨éªŒè¯é›†å¯¹å·²ç”Ÿæˆçš„äºŒå‰å†³ç­–æ ‘è¿›è¡Œå‰ªæï¼Œå‰ªæçš„æ ‡å‡†ä¸ºæŸå¤±å‡½æ•°æœ€å°åŒ–ã€‚

ç”±äºåˆ†ç±»æ ‘ä¸å›å½’æ ‘åœ¨é€’å½’åœ°æ„å»ºäºŒå‰å†³ç­–æ ‘çš„è¿‡ç¨‹ä¸­ï¼Œé€‰æ‹©ç‰¹å¾åˆ’åˆ†çš„å‡†åˆ™ä¸åŒã€‚

- äºŒå‰åˆ†ç±»æ ‘æ„å»ºè¿‡ç¨‹ä¸­é‡‡ç”¨`åŸºå°¼æŒ‡æ•°ï¼ˆGini Indexï¼‰`ä¸ºç‰¹å¾é€‰æ‹©æ ‡å‡†ï¼›
- äºŒå‰å›å½’æ ‘é‡‡ç”¨`å¹³æ–¹è¯¯å·®æœ€å°åŒ–`ä½œä¸ºç‰¹å¾é€‰æ‹©æ ‡å‡†ã€‚

### 5.3 æ ‘çš„æ„å»º

#### 5.3.1 äºŒå‰å›å½’æ ‘

è®¾ $X$, $Y$ åˆ†åˆ«ä¸ºè¾“å…¥å’Œè¾“å‡ºå˜é‡ï¼Œå…¶ä¸­ $Y$ ä¸ºè¿ç»­å˜é‡ï¼Œç»™å®šè®­ç»ƒæ•°æ®é›† $D= \lbrace (x\_1, y\_1), (x\_2, y\_2),â€¦,(x\_N, y\_N) \rbrace$

> å†³ç­–æ ‘çš„ç”Ÿæˆå°±æ˜¯é€’å½’åœ°æ„å»ºäºŒå‰å†³ç­–æ ‘çš„è¿‡ç¨‹ï¼Œå¯¹å›å½’æ ‘ç”¨å¹³æ–¹è¯¯å·®æœ€å°åŒ–å‡†åˆ™ï¼Œå¯¹åˆ†ç±»æ ‘ç”¨åŸºå°¼æŒ‡æ•°æœ€å°åŒ–å‡†åˆ™ï¼Œè¿›è¡Œç‰¹å¾é€‰æ‹©ï¼Œç”ŸæˆäºŒå‰æ ‘

ä¸€ä¸ªå›å½’æ ‘å¯¹åº”ç€è¾“å…¥ç©ºé—´ï¼ˆå³ç‰¹å¾ç©ºé—´ï¼‰çš„ä¸€ä¸ªåˆ’åˆ†ä»¥åŠåœ¨åˆ’åˆ†çš„å•å…ƒä¸Šçš„è¾“å‡ºå€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ä¸»è¦ç›®çš„æ˜¯è¦æ„å»ºå›å½’æ ‘ï¼Œä¹Ÿå°±æ˜¯**å¦‚ä½•åˆ’åˆ†è¾“å…¥ç©ºé—´**ï¼Œå› ä¸ºä¸€æ—¦åˆ’åˆ†å¥½è¾“å…¥ç©ºé—´ï¼Œå¦‚å°†è¾“å…¥ç©ºé—´åˆ’åˆ†ä¸º $M$ ä¸ªå•å…ƒ, $R\_1, R\_2, â€¦ , R\_M$ , å¹¶ä¸”åœ¨æ¯ä¸ªå•å…ƒ $R\_m$ ä¸Šæœ‰ä¸€ä¸ªå›ºå®šçš„è¾“å‡ºå€¼ $c\_m$ï¼Œé‚£ä¹ˆå›å½’æ ‘çš„æ¨¡å‹å°±å¯ä»¥è¡¨ç¤ºä¸º

$$
f(x)=\sum\_{m=1}^Mc\_mI(x \in R\_m)
$$

**æ¦‚å¿µå¼ºè°ƒ**

`é¦–å…ˆè¦å¼ºè°ƒçš„æ˜¯ CARTå‡è®¾å†³ç­–æ ‘æ˜¯äºŒå‰æ ‘ï¼Œå†…éƒ¨ç»“ç‚¹ç‰¹å¾çš„å–å€¼åªæœ‰â€œæ˜¯â€å’Œâ€œå¦â€ï¼Œå·¦åˆ†æ”¯æ˜¯å–å€¼ä¸ºâ€œæ˜¯â€çš„åˆ†æ”¯ï¼Œæœ‰åˆ†æ”¯åˆ™ç›¸åã€‚è¿™æ ·çš„å†³ç­–æ ‘ç­‰ä»·äºé€’å½’åœ°äºŒåˆ†æ¯ä¸ªç‰¹å¾`.

**æœ€å°äºŒå‰å›å½’æ ‘ç”Ÿæˆç®—æ³•**

> è¾“å…¥ï¼šè®­ç»ƒæ•°æ®é›†$D$ï¼›
> è¾“å‡ºï¼šå›å½’æ ‘ $f(x)$
>
> ç®—æ³•ï¼šåœ¨è®­ç»ƒé›†æ‰€åœ¨çš„è¾“å…¥ç©ºé—´ä¸­ï¼Œé€’å½’åœ°å°†æ¯ä¸ªåŒºåŸŸåˆ’åˆ†ä¸ºä¸¤ä¸ªå­åŒºåŸŸå¹¶å†³å®šæ¯ä¸ªå­åŒºåŸŸä¸Šè¾“å‡ºå€¼ï¼Œæ„å»ºäºŒå‰å†³ç­–æ ‘

(1). æ‹©æœ€ä¼˜åˆ‡åˆ†å˜é‡$j$ä¸åˆ‡åˆ†ç‚¹$s$ï¼Œæ±‚è§£

$$
\min\_{j,s}[\min\_{c\_1} \sum\_{x\_i\in R\_1(j,s)}(y\_i-c\_1)^2 + \min\_{c\_2} \sum\_{x\_i\in R\_2(j,s)}(y\_i-c\_2)^2]
$$

> éå†å˜é‡$j$ï¼Œå¯¹å›ºå®šçš„åˆ‡åˆ†å˜é‡$j$æ‰«æåˆ‡åˆ†ç‚¹$s$ï¼Œé€‰æ‹©ä½¿ä¸Šå¼æœ€å°å€¼çš„å¯¹$(j,s)$ã€‚å…¶ä¸­$R\_m$æ˜¯è¢«åˆ’åˆ†çš„è¾“å…¥ç©ºé—´ï¼Œ$c\_m$æ˜¯ç©ºé—´$R\_m$å¯¹åº”çš„å›ºå®šè¾“å‡ºå€¼ã€‚

(2). ç”¨é€‰å®šçš„å¯¹$(j,s)$åˆ’åˆ†åŒºåŸŸå¹¶å†³å®šç›¸åº”çš„è¾“å‡ºå€¼ï¼š

$$
R_1(j,s)=\lbrace x\mid x^{(j)} \le s \rbrace , \quad R_2(j,s)=\lbrace x \mid x^{(j)} \gt s \rbrace
$$

$$
 \hat c\_m = {1\over N\_m}\sum\_{x\_i\in R\_m(j,s)}y\_i , \quad x\in R\_m , m=1,2
$$

(3). ç»§ç»­å¯¹ä¸¤ä¸ªå­åŒºåŸŸè°ƒç”¨æ­¥éª¤ï¼ˆ1ï¼‰ï¼Œï¼ˆ2ï¼‰ï¼Œç›´è‡³æ»¡è¶³åœæ­¢æ¡ä»¶ã€‚

(4). å°†è¾“å…¥ç©ºé—´åˆ’åˆ†ä¸º$M$ä¸ªåŒºåŸŸ$R\_1$,$R\_2$ , â€¦ , $R\_M$ï¼Œç”Ÿæˆå†³ç­–æ ‘ï¼š

$$
f(x) = \sum\_{m=1}^M\hat c\_m I(x\in R)
$$

ä¸¾ä¸ªğŸŒ°ğŸŒ°ğŸŒ°:

è®­ç»ƒæ•°æ®è§ä¸‹è¡¨ï¼Œ$x$ çš„å–å€¼èŒƒå›´ä¸ºåŒºé—´ $[0.5,10.5]$, $y$ çš„å–å€¼èŒƒå›´ä¸ºåŒºé—´$[5.0,10.0]$ ,å­¦ä¹ è¿™ä¸ªå›å½’é—®é¢˜çš„æœ€å°äºŒå‰å›å½’æ ‘ã€‚

$x\_i$	| 1 | 	2 | 3 | 4 | 5 | 	6 | 7 | 8 | 9 | 10
---- | --- | --- | --- | --- | --- | --- | --- | --- | ---
$y\_i$	| 5.56	| 5.70	| 5.91	| 6.40	| 6.80	| 7.05 | 8.90 | 8.70 | 9.00 | 9.05

**é¦–å…ˆæ¥çœ‹è¿™ä¸ªä¼˜åŒ–é—®é¢˜**

$$
\min\_{j,s}[\min\_{c\_1} \sum\_{x\_i\in R\_1(j,s)}(y\_i-c\_1)^2 + \min\_{c\_2} \sum\_{x\_i\in R\_2(j,s)}(y\_i-c\_2)^2]
$$

æ±‚è§£è®­ç»ƒæ•°æ®çš„åˆ‡åˆ†ç‚¹s:

$$
R_1(j,s)=\lbrace x\mid x^{(j)} \le s \rbrace , \quad R_2(j,s)=\lbrace x \mid x^{(j)} \gt s \rbrace
$$

å®¹æ˜“æ±‚å¾—åœ¨ $R\_1$,$R\_2$ å†…éƒ¨ä½¿å¾—å¹³æ–¹æŸå¤±è¯¯å·®è¾¾åˆ°æœ€å°å€¼çš„ $c\_1$,$c\_2$ ä¸ºï¼š

$$
c\_1={1\over N\_1}\sum\_{x\_i \in R\_1}y\_i , \quad c\_2={1\over N\_2}\sum\_{x\_i \in R\_2}y\_i
$$

è¿™é‡Œ $N\_1$,$N\_2$ æ˜¯ $R\_1$,$R\_2$çš„æ ·æœ¬ç‚¹æ•°ã€‚

æ±‚è®­ç»ƒæ•°æ®çš„åˆ‡åˆ†ç‚¹ï¼Œæ ¹æ®æ‰€ç»™æ•°æ®ï¼Œè€ƒè™‘å¦‚ä¸‹åˆ‡åˆ†ç‚¹ï¼š

$$1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5$$

å¯¹å„åˆ‡åˆ†ç‚¹ï¼Œä¸éš¾æ±‚å‡ºç›¸åº”çš„ $R\_1$ , $R\_2$ , $c\_1$ , $c\_2$ åŠ

$$
m(s)=\min\_{j,s}[\min\_{c\_1} \sum\_{x\_i\in R\_1(j,s)}(y\_i-c\_1)^2 + \min\_{c\_2} \sum\_{x\_i\in R\_2(j,s)}(y\_i-c\_2)^2]
$$

ä¾‹å¦‚ï¼Œå½“ $s=1.5$ æ—¶ï¼Œ$R\_1 = \lbrace 1\rbrace$, $R\_2 = \lbrace 2, 3 , \ldots , 10\rbrace$, $c\_1 = 5.56$, $c\_2 = 7.50$, 

$$
m(s)=\min\_{j,s}[\min\_{c\_1} \sum\_{x\_i\in R\_1(j,s)}(y\_i-c\_1)^2 + \min\_{c\_2} \sum\_{x\_i\in R\_2(j,s)}(y\_i-c\_2)^2] = 0+15.72 = 15.72
$$

ç°å°†$s$åŠ$m(s)$çš„è®¡ç®—ç»“æœåˆ—è¡¨å¦‚ä¸‹ï¼š

s | 1.5 | 2.5	 | 3.5 | 4.5 | 5.5 | 6.5 | 7.5 | 8.5 | 9.5
---- | --- | --- | --- | --- | --- | --- | --- | --- | ---
m(s) | 15.72	| 12.07 | 8.36 | 5.78 | 3.91 | 1.93 | 8.01 | 11.73 | 15.74

ç”±ä¸Šè¡¨å¯çŸ¥ï¼Œå½“$x=6.5$çš„æ—¶å€™è¾¾åˆ°æœ€å°å€¼ï¼Œæ­¤æ—¶ $R\_1 = \lbrace 1 ,2 , \ldots , 6\rbrace$, $R\_2 ={7 ,8 ,9 , 10}$, $c\_1 = 6.24$, $c\_2 = 8.9$

æ‰€ä»¥å›å½’æ ‘ $T\_1(x)$ ä¸ºï¼š

$$
T\_1(x) =
\begin{cases}
6.24, & x\lt 6.5 \\\\
8.91, & x \ge 6.5 \\\\
\end{cases}
$$

$$
f\_1(x) = T\_1(x)
$$

ç”¨ $f\_1(x)$ æ‹Ÿåˆè®­ç»ƒæ•°æ®çš„æ®‹å·®è§ä¸‹è¡¨ï¼Œè¡¨ä¸­ $r\_{2i} = y\_i - f\_1(x\_i),i=1,2,\ldots , 10$

$x\_i$ | 	1	| 2 | 	3 | 4 | 5 | 6	 | 7 | 8 | 9 | 10
---- | --- | --- | --- | --- | --- | --- | --- | --- | ---
$y\_i$ | -0.68 | -0.54 | -0.33 | 0.16 | 0.56 | 0.81 | -0.01 | -0.21 | 0.09 | 0.14

ç”¨$f\_1(x)$æ‹Ÿåˆè®­ç»ƒæ•°æ®çš„å¹³æ–¹è¯¯å·®ï¼š

$$
L(y,f\_1(x)) = \sum\_{i=1}^{10}(y\_i-f\_1(x\_i))^2 = 1.93
$$

ç¬¬2æ­¥æ±‚ $T\_2(x)$.æ–¹æ³•ä¸æ±‚ $T\_1(x)$ ä¸€æ ·ï¼Œåªæ˜¯æ‹Ÿåˆçš„æ•°æ®æ˜¯ä¸Šè¡¨çš„æ®‹å·®ï¼Œå¯ä»¥å¾—åˆ°ï¼š

$$
T\_2(x) =
\begin{cases}
-0.52, & x\lt 3.5 \\\\
0.22, & x \ge 3.5 \\\\
\end{cases}
$$

$$
f\_2(x) = f\_1(x) + T\_2(x)=
\begin{cases}
5.72, & x\lt 3.5 \\\\
6.46, & 3.5\le x \lt 6.5 \\\\
9.13, & x\ge 6.5 \\\\
\end{cases}
$$

ç”¨$f\_2(x)$æ‹Ÿåˆè®­ç»ƒæ•°æ®çš„å¹³æ–¹è¯¯å·®æ˜¯ï¼š

$$
L(y,f\_2(x)) = \sum\_{i=1}^{10}(y\_i-f\_2(x\_i))^2 = 0.79
$$

ç»§ç»­æ±‚å¾—

$$
T\_3(x) =
\begin{cases}
0.15, & x\lt 6.5 \\\\
-0.22, & x \ge 6.5 \\\\
\end{cases}
\quad L(y,f\_3(x)) = 0.47 ,
$$

$$
T\_4(x) =
\begin{cases}
-0.16, & x\lt 4.5 \\\\
0.11, & x \ge 4.5 \\\\
\end{cases}
\quad L(y,f\_3(x)) = 0.30 ,
$$

$$
T\_5(x) =
\begin{cases}
0.07, & x\lt 6.5 \\\\
-0.11, & x \ge 6.5 \\\\
\end{cases}
\quad L(y,f\_3(x)) = 0.23 ,
$$

$$
T\_6(x) =
\begin{cases}
-0.15, & x\lt 2.5 \\
0.04, & x \ge 2.5 \\
\end{cases}
$$

$$
f\_6(x) = f\_5(x)+T\_6(x) =T\_1(x)+ \ldots + T\_5(x) + T\_6(x)=
\begin{cases}
5.63, & x\lt 2.5 \\\\
5.82, & 2.5 \le x\lt 3.5 \\\\
6.56, & 3.5 \le x\lt 4.5 \\\\
6.83, & 4.5 \le x\lt 6.5 \\\\
8.95, & x\ge 6.5 \\\\
\end{cases}
$$

ç”¨$f\_6(x)$æ‹Ÿåˆè®­ç»ƒæ•°æ®çš„å¹³æ–¹æŸå¤±è¯¯å·®æ˜¯

$$
L(y,f\_6(x)) = \sum\_{i=1}^{10}(y\_i-f\_6(x\_i))^2 = 0.71
$$

å‡è®¾æ­¤æ—¶å·²ç»æ»¡è¶³è¯¯å·®è¦æ±‚ï¼Œé‚£ä¹ˆ $f(x) = f\_6(x)$ å³ä¸ºæ‰€æ±‚çš„å›å½’æ ‘ã€‚

#### 5.3.2 äºŒå‰åˆ†ç±»æ ‘

äºŒå‰åˆ†ç±»æ ‘ä¸­ç”¨åŸºå°¼æŒ‡æ•°ï¼ˆGini Indexï¼‰ä½œä¸ºæœ€ä¼˜ç‰¹å¾é€‰æ‹©çš„åº¦é‡æ ‡å‡†ã€‚åŸºå°¼æŒ‡æ•°å®šä¹‰å¦‚ä¸‹ï¼š

**Gini Index :**

1. æ˜¯ä¸€ç§ä¸ç­‰æ€§åº¦é‡ï¼›
2. é€šå¸¸ç”¨æ¥åº¦é‡æ”¶å…¥ä¸å¹³è¡¡ï¼Œå¯ä»¥ç”¨æ¥åº¦é‡ä»»ä½•ä¸å‡åŒ€åˆ†å¸ƒï¼›
3. æ˜¯ä»‹äº0~1ä¹‹é—´çš„æ•°ï¼Œ0-å®Œå…¨ç›¸ç­‰ï¼Œ1-å®Œå…¨ä¸ç›¸ç­‰ï¼›
4. æ€»ä½“å†…åŒ…å«çš„ç±»åˆ«è¶Šæ‚ä¹±ï¼ŒGINIæŒ‡æ•°å°±è¶Šå¤§ï¼ˆè·Ÿç†µçš„æ¦‚å¿µå¾ˆç›¸ä¼¼ï¼‰

**Gini Index :**

åŒæ ·ä»¥åˆ†ç±»ç³»ç»Ÿä¸ºä¾‹ï¼Œæ•°æ®é›† $D$ ä¸­ç±»åˆ« $C$ å¯èƒ½çš„å–å€¼ä¸º$c\_1, c\_2, \cdots, c\_k$ ï¼ˆ$k$æ˜¯ç±»åˆ«æ•°ï¼‰ï¼Œä¸€ä¸ªæ ·æœ¬å±äºç±»åˆ« $c\_i$ çš„æ¦‚ç‡ä¸º$p(i)$ã€‚é‚£ä¹ˆæ¦‚ç‡åˆ†å¸ƒçš„ Gini index å…¬å¼è¡¨ç¤ºä¸ºï¼š

$$ 
Gini(D) = 1 - \sum_{i=1}^{k} {p\_i}^2    \qquad(fmt.2.1.1)
$$

> å…¶ä¸­$p\_i = \frac{ç±»åˆ«å±äºc\_içš„æ ·æœ¬æ•°}{æ€»æ ·æœ¬æ•°}$ã€‚å¦‚æœæ‰€æœ‰çš„æ ·æœ¬ Category ç›¸åŒï¼Œåˆ™ $p_1 = 1, p_2 = p_3 = \cdots = p_k = 0$ï¼Œåˆ™æœ‰$p_1 = 1, p_2 = p_3 = \cdots = p_k = 0$ï¼Œæ­¤æ—¶æ•°æ®ä¸çº¯åº¦æœ€ä½ã€‚$Gini(D)$ çš„ç‰©ç†å«ä¹‰æ˜¯è¡¨ç¤ºæ•°æ®é›† $D$ çš„ä¸ç¡®å®šæ€§ã€‚æ•°å€¼è¶Šå¤§ï¼Œè¡¨æ˜å…¶ä¸ç¡®å®šæ€§è¶Šå¤§ï¼ˆè¿™ä¸€ç‚¹ä¸ [Info Entropy][5] ç›¸ä¼¼ï¼‰ã€‚
å¦‚æœ $k=2$ï¼ˆäºŒåˆ†ç±»é—®é¢˜ï¼Œç±»åˆ«å‘½åä¸ºæ­£ç±»å’Œè´Ÿç±»ï¼‰ï¼Œè‹¥æ ·æœ¬å±äºæ­£ç±»çš„æ¦‚ç‡æ˜¯ $p$ï¼Œé‚£ä¹ˆå¯¹åº”åŸºå°¼æŒ‡æ•°ä¸ºï¼š

> $$
\begin{align} Gini(D) & = 1 - [p^2 + {(1-p)}^2] \\\ & = \underline {2p (1-p)} \qquad\qquad (fmt.2.1.2)
\end{align}
$$

å¦‚æœæ•°æ®é›† $D$ æ ¹æ®ç‰¹å¾ $f$ æ˜¯å¦å–æŸä¸€å¯èƒ½å€¼ $f\_âˆ—$ï¼Œå°† $D$ åˆ’åˆ†ä¸º $D\_1=\{(x, y) \in D | f(x) = f\_{\ast}\}, D\_2=D-D\_1$ã€‚é‚£ä¹ˆç‰¹å¾ $f$ åœ¨æ•°æ®é›† $D$ ä¸Šçš„ Gini index å®šä¹‰ä¸ºï¼š

$$
Gini(D, f=f\_{\ast}) = \frac{\vert D_1 \vert}{\vert D \vert} Gini(D\_1) + \frac{\vert D\_2 \vert}{\vert D \vert} Gini(D_2) \qquad\qquad (fmt.2.1.3)
$$

ä»£è¡¨æ€§çš„ä¾‹å­è¯´æ˜ :

ID | é˜´æ™´(F)	| æ¸©åº¦(F)	| æ¹¿åº¦(F)	| åˆ®é£(F)	| æ˜¯å¦ç©ï¼ˆCï¼‰
:-------: | :-------: | :-------: | :-------: | :-------: | :-------:
1	| sunny |	hot	 |	high |	false | å¦
2	| sunny |	hot	 |	high |	true |	å¦
3	| overcast |	hot	 |	high |	false |	æ˜¯
4	| rainy |	mild |	high |	false |	æ˜¯
5	| rainy |	cool |	normal |	false |	æ˜¯
6	| rainy |	cool |	normal |	true |	å¦
7	| overcast |	cool |	normal |	true |	æ˜¯
8	| sunny |	mild |	high |	false | å¦
9	| sunny |	cool |	normal | false |	æ˜¯
10	| rainy |	mild |	normal | false |	æ˜¯
11	| sunny |	mild |	normal | true |	æ˜¯
12	| overcast |	mild |	high |	true |	æ˜¯
13	| overcast |	hot |	normal |false | æ˜¯
14	| rainy |	mild |	high |	true |	å¦

**ä¸‹å›¾æ˜¯ IG çš„å†³ç­–æ ‘ï¼Œå¹¶ä¸æ˜¯ äºŒåˆ†åˆ†ç±»æ ‘ ${Gini}$ ${index}$ å†³ç­–æ ‘, æ”¾è¿™é‡Œä»…ä»…æ˜¯ä¸ºäº†æ„ŸçŸ¥ä¸€ä¸‹**

<img src="/images/ml/decision-tree/decision-tree-2.png" width="530" /img>

åœ¨å®é™…æ“ä½œä¸­ï¼Œé€šè¿‡éå†æ‰€æœ‰ç‰¹å¾ï¼ˆå¦‚æœæ˜¯è¿ç»­å€¼ï¼Œéœ€åšç¦»æ•£åŒ–ï¼‰åŠå…¶å–å€¼ï¼Œé€‰æ‹© $Min_{gini-index}$ æ‰€å¯¹åº”çš„ç‰¹å¾å’Œç‰¹å¾å€¼ã€‚

è¿™é‡Œä»ç„¶ä»¥å¤©æ°”æ•°æ®ä¸ºä¾‹ï¼Œç»™å‡ºç‰¹å¾**é˜´æ™´**çš„ Gini index è®¡ç®—è¿‡ç¨‹ã€‚

> (1). å½“ç‰¹å¾â€œé˜´æ™´â€å–å€¼ä¸ºâ€sunnyâ€æ—¶ï¼Œ$D\_1 = \{1,2,8,9,11\}, |D\_1|=5$ï¼›$D\_2=\{3,4,5,6,7,10,12,13,14\}, |D\_2|=9$. æ•°æ®è‡ªå·±å¯¹åº”çš„ç±»åˆ«æ•°åˆ†åˆ«ä¸º $(+2,-3)ã€(+7,-2)$ã€‚å› æ­¤ $Gini(D\_1) = 2 \cdot \frac{3}{5} \cdot \frac{2}{5} = \frac{12}{25}$ï¼›$Gini(D_2) = 2 \cdot \frac{7}{9} \cdot \frac{2}{9} = \frac{28}{81}$. å¯¹åº”çš„åŸºå°¼æŒ‡æ•°ä¸ºï¼š
$$
Gini(C, â€œé˜´æ™´â€=â€sunnyâ€) = \frac{5}{14} Gini(D_1) + \frac{9}{14} Gini(D_2) = \frac{5}{14} \frac{12}{25} + \frac{9}{14} \frac{28}{81} = 0.394 \quad(exp.2.2.1)
$$
> (2). å½“ç‰¹å¾â€œé˜´æ™´â€å–å€¼ä¸ºâ€overcastâ€æ—¶ï¼Œ$D\_1 = \{2,7,12,13\}, |D\_1|=4$ï¼›$D\_2=\{1,2,4,5,6,8,9,10,11,14\}, |D\_2|=10$ã€‚$D\_1$ã€$D\_2$ æ•°æ®è‡ªå·±å¯¹åº”çš„ç±»åˆ«æ•°åˆ†åˆ«ä¸º $(+4,-0)ã€(+5,-5)$ã€‚å› æ­¤ $Gini(D\_1) = 2 \cdot 1 \cdot 0 = 0ï¼›Gini(D\_2) = 2 \cdot \frac{5}{10} \cdot \frac{5}{10} = \frac{1}{2}$ å¯¹åº”çš„åŸºå°¼æŒ‡æ•°ä¸ºï¼š
$$
Gini(C, â€œé˜´æ™´â€=â€overcastâ€) = \frac{4}{14} Gini(D_1) + \frac{10}{14} Gini(D_2) = 0 + \frac{10}{14} \cdot \frac{1}{2} = \frac{5}{14} = 0.357 \quad(exp.2.2.2)
$$

> (3). å½“ç‰¹å¾â€œé˜´æ™´â€å–å€¼ä¸ºâ€rainyâ€æ—¶ï¼Œ$D\_1 = \{4,5,6,10,14\}, |D\_1|=5$; $D_2=\{1,2,3,7,8,9,11,12,13\}, |D_2|=9$ã€‚ $D\_1$ã€$D\_2$ æ•°æ®è‡ªå·±å¯¹åº”çš„ç±»åˆ«æ•°åˆ†åˆ«ä¸º $(+3,âˆ’2)ã€(+6,âˆ’3)$ã€‚å› æ­¤ $Gini(D\_1) = 2 \cdot \frac{3}{5} \cdot \frac{2}{5} = \frac{12}{25}$ï¼›$Gini(D\_2) = 2 \cdot \frac{6}{9} \cdot \frac{3}{9} = \frac{4}{9}$ã€‚ å¯¹åº”çš„åŸºå°¼æŒ‡æ•°ä¸ºï¼š
$$
Gini(C, â€œé˜´æ™´â€=â€rainyâ€) = \frac{5}{14} Gini(D_1) + \frac{9}{14} Gini(D_2) = \frac{5}{14} \frac{12}{25} + \frac{9}{14} \frac{4}{9} = \frac{4}{7} = 0.457 \quad(exp.2.2.3)
$$

å¦‚æœç‰¹å¾â€é˜´æ™´â€æ˜¯æœ€ä¼˜ç‰¹å¾çš„è¯ï¼Œé‚£ä¹ˆç‰¹å¾å–å€¼ä¸ºâ€overcastâ€åº”ä½œä¸ºåˆ’åˆ†èŠ‚ç‚¹ã€‚

## 6. å†³ç­–æ ‘æ¨¡å‹çš„ä¼˜ç¼ºç‚¹

### 6.1 ä¼˜ç‚¹

- å¯è§£é‡Šæ€§â€“æ¨¡æ‹Ÿäººç±»å†³ç­–è¿‡ç¨‹
- è®­ç»ƒã€é¢„æµ‹æ•ˆç‡è¾ƒé«˜â€“å…³äºå…¶åˆ‡åˆ†æ–¹å¼ï¼Œæ¯æ¬¡æ˜¯åœ¨ä¸€ä¸ªæ¡ä»¶ä¸‹çš„å±€éƒ¨ç©ºé—´åˆ’åˆ†æ ·æœ¬ï¼Œè€Œç±»ä¼¼Adabooståˆ™æ˜¯æ¯æ¬¡åœ¨æ•´ä¸ªç©ºé—´åˆ’åˆ†æ ·æœ¬ï¼Œæ‰€ä»¥å°±å†³ç­–æ ‘è€Œè¨€ç›¸å¯¹é«˜æ•ˆ
- é€‚ç”¨äºç±»åˆ«ç±»å‹æ•°æ®â€“decision set(ç©·ä¸¾ç±»åˆ«ç‰¹å¾å€¼ç„¶åæŒ‰ç…§ç‰¹å¾å€¼çš„å­é›†é›†åˆæ¥åˆ’åˆ†æ ·æœ¬)
- èƒ½å¤Ÿå¾ˆæ–¹ä¾¿çš„ç”±äºŒåˆ†ç±»æ¨¡å‹è½¬æ¢ä¸ºå¤šåˆ†ç±»æ¨¡å‹â€“ä¸»è¦ä¿®æ”¹ä¸çº¯åº¦è®¡ç®—ä»¥åŠè¿”å›å€¼çš„è®¾ç½®
- èƒ½å¤Ÿå¤„ç†ç¼ºå¤±ç‰¹å¾å€¼â€“ç”¨å…¶ä»–çš„ç‰¹å¾å€¼æ¥æ›¿ä»£è¿›è¡Œåˆ’åˆ†(ä¸€èˆ¬è¦æ±‚æ›¿ä»£ç‰¹å¾åˆ’åˆ†ç»“æœæ¥è¿‘ç¼ºå¤±ç‰¹å¾å€¼)
- æ˜“äºå®ç°

### 6.2 ç¼ºç‚¹

- ç»éªŒå¤šäºç†è®ºï¼Œå¤§å¤šæ•°å†³ç­–æ ‘æ¨¡å‹æ˜¯æ ¹æ®ç»éªŒæ¥åˆ¤æ–­çš„ï¼Œæ•ˆæœå¥½åå°šæ— è¾ƒå¥½çš„ç†è®ºæ”¯æ’‘

## Reference article

- [é€—æ¯”ç®—æ³•å·¥ç¨‹å¸ˆ][9]ã€[ç®—æ³•æ‚è´§é“º][10]
- [52caml][11]ã€[æ‡’æ­»éª†é©¼][12]
- [å†³ç­–æ ‘ID3ã€C4.5ã€CARTç®—æ³•ï¼šä¿¡æ¯ç†µï¼ŒåŒºåˆ«ï¼Œå‰ªæç†è®ºæ€»ç»“][c2]
- [Markdown å­¦ä¹ å¥½æ•™æ][13]ã€[CARTä¹‹å›å½’æ ‘æ„å»º][14]
- ã€Šæœºå™¨å­¦ä¹ å¯¼è®ºã€‹ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹

[c1]: http://blog.csdn.net/blueloveyyt/article/details/45013403
[c2]: http://blog.csdn.net/ljp812184246/article/details/47402639

[1]: /images/model-dt-01.jpg
[2]: /images/model-dt-02.png
[3]: /2016/08/18/ml-entropy-base/
[4]: /2016/08/24/ml-CART/

[5]: https://en.wikipedia.org/wiki/Heuristic_(computer_science)
[6]: https://en.wikipedia.org/wiki/Greedy_algorithm
[7]: https://en.wikipedia.org/wiki/ID3_algorithm
[8]: https://en.wikipedia.org/wiki/C4.5_algorithm

[9]: http://www.cnblogs.com/fengfenggirl/p/classsify_decision_tree.html
[10]: http://www.52caml.com/
[11]: http://www.cnblogs.com/leoo2sk/archive/2010/09/19/decision-tree.html
[12]: http://izhaoyi.top/2017/06/19/Decision-Tree
[13]: https://www.zybuluo.com/mdeditor
[14]: https://cethik.vip/2016/09/21/machineCAST/

[part1]: /2016/08/16/ml-5-decisionTree-part1/
