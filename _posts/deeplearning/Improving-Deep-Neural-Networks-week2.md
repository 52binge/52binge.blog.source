---
title: Improving Deep Neural Networks (week2) - Optimization Algorithm
toc: true
date: 2018-07-21 10:00:21
categories: deeplearning
tags: deeplearning.ai
---

Mini-batchã€æŒ‡æ•°åŠ æƒå¹³å‡-åå·®ä¿®æ­£ã€Momentumã€RMSpropã€Adamã€å­¦ä¹ ç‡è¡°å‡ã€å±€éƒ¨æœ€ä¼˜

è¿™èŠ‚è¯¾æ¯ä¸€èŠ‚çš„çŸ¥è¯†ç‚¹éƒ½å¾ˆé‡è¦ï¼Œæ‰€ä»¥æœ¬æ¬¡ç¬”è®°å‡ ä¹æ¶µç›–äº†å…¨éƒ¨å°è§†é¢‘è¯¾ç¨‹çš„è®°å½•

<!-- more -->


## 1. Mini-batch

> éšæœºæ¢¯åº¦ä¸‹é™æ³•çš„ä¸€å¤§ç¼ºç‚¹æ˜¯, ä½ ä¼šå¤±å»æ‰€æœ‰å‘é‡åŒ–å¸¦ç»™ä½ çš„åŠ é€Ÿï¼Œå› ä¸ºä¸€æ¬¡æ€§åªå¤„ç†äº†ä¸€ä¸ªæ ·æœ¬ï¼Œè¿™æ ·æ•ˆç‡è¿‡äºä½ä¸‹, æ‰€ä»¥å®è·µä¸­æœ€å¥½ é€‰æ‹©ä¸å¤§ä¸å° çš„ Mini-batch å°ºå¯¸. å®é™…ä¸Šå­¦ä¹ ç‡è¾¾åˆ°æœ€å¿«ï¼Œä½ ä¼šå‘ç°2ä¸ªå¥½å¤„ï¼Œä½ å¾—åˆ°äº†å¤§é‡å‘é‡åŒ–ï¼Œå¦ä¸€æ–¹é¢ ä½ ä¸éœ€è¦ç­‰å¾…æ•´ä¸ªè®­ç»ƒé›†è¢«å¤„ç†å®Œï¼Œä½ å°±å¯ä»¥å¼€å§‹è¿›è¡Œåç»­å·¥ä½œ.
> 
> å®ƒä¸ä¼šæ€»æœç€æœ€å°å€¼é è¿‘ï¼Œä½†å®ƒæ¯”éšæœºæ¢¯åº¦ä¸‹é™è¦æ›´æŒç»­åœ°é è¿‘æœ€å°å€¼çš„æ–¹å‘. å®ƒä¹Ÿä¸ä¸€å®šåœ¨å¾ˆå°çš„èŒƒå›´å†…æ”¶æ•›ï¼Œå¦‚å‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥å‡å° å­¦ä¹ ç‡.
> 
> æ ·æœ¬é›†æ¯”è¾ƒå°ï¼Œå°±æ²¡å¿…è¦ä½¿ç”¨ mini-batch.
> 
> **ç»éªŒå€¼** ï¼š å¦‚æœ m <= 2000, å¯ä»¥ä½¿ç”¨ batchï¼Œ ä¸ç„¶æ ·æœ¬æ•°ç›® m è¾ƒå¤§ï¼Œä¸€èˆ¬ mini-batch å¤§å°è®¾ç½®ä¸º 64 or 128 or.. or 512..

**ç®—æ³•åˆæ­¥**

> å¯¹æ•´ä¸ªè®­ç»ƒé›†è¿›è¡Œæ¢¯åº¦ä¸‹é™æ³•çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¿…é¡»å¤„ç†æ•´ä¸ªè®­ç»ƒæ•°æ®é›†ï¼Œç„¶åæ‰èƒ½è¿›è¡Œä¸€æ­¥æ¢¯åº¦ä¸‹é™ï¼Œå³æ¯ä¸€æ­¥æ¢¯åº¦ä¸‹é™æ³•éœ€è¦å¯¹æ•´ä¸ªè®­ç»ƒé›†è¿›è¡Œä¸€æ¬¡å¤„ç†ï¼Œå¦‚æœè®­ç»ƒæ•°æ®é›†å¾ˆå¤§çš„æ—¶å€™ï¼Œå¦‚æœ‰ 500ä¸‡ æˆ– 5000ä¸‡ çš„è®­ç»ƒæ•°æ®ï¼Œå¤„ç†é€Ÿåº¦å°±ä¼šæ¯”è¾ƒæ…¢ã€‚
>
> ä½†æ˜¯å¦‚æœæ¯æ¬¡å¤„ç†è®­ç»ƒæ•°æ®çš„ä¸€éƒ¨åˆ†å³è¿›è¡Œæ¢¯åº¦ä¸‹é™æ³•ï¼Œåˆ™æˆ‘ä»¬çš„ç®—æ³•é€Ÿåº¦ä¼šæ‰§è¡Œçš„æ›´å¿«ã€‚è€Œå¤„ç†çš„è¿™äº›ä¸€å°éƒ¨åˆ†è®­ç»ƒå­é›†å³ç§°ä¸º Mini-batchã€‚

{% image "/images/deeplearning/C2W2-1_1.png", width="700px" %}

> å¦‚å›¾ï¼Œä»¥ 1000 ä¸ºå•ä½ï¼Œå°†æ•°æ®åˆ’åˆ†ï¼Œä»¤ $x^{\\{1\\}}=\\{x^{(1)},x^{(2)}â€¦â€¦x^{(1000)}\\}$, ä¸€èˆ¬ç”¨ $x^{ \\{ t \\} }$, $y^{ \\{t\\} }$ è¡¨ç¤ºåˆ’åˆ†åçš„ mini-batch.
> 
> æ³¨æ„åŒºåˆ†è¯¥ç³»åˆ—æ•™å­¦è§†é¢‘çš„ç¬¦å·æ ‡è®°ï¼š
> - å°æ‹¬å·() è¡¨ç¤ºå…·ä½“çš„æŸä¸€ä¸ªå…ƒç´ ï¼ŒæŒ‡ä¸€ä¸ªå…·ä½“çš„å€¼ï¼Œä¾‹å¦‚ $x^{(i)}$
> - ä¸­æ‹¬å·[] è¡¨ç¤ºç¥ç»ç½‘ç»œä¸­çš„æŸä¸€å±‚, ä¾‹å¦‚ $Z^{[l]}$
> - å¤§æ‹¬å·{} è¡¨ç¤ºå°†æ•°æ®ç»†åˆ†åçš„ä¸€ä¸ªé›†åˆ, ä¾‹å¦‚ $x^{\\{1\\}} = \\{x^{(1)},x^{(2)}â€¦â€¦x^{(1000)}\\}$

**ç®—æ³•æ ¸å¿ƒ**

{% image "/images/deeplearning/C2W2-2_1.png", width="700px" %}

> å‡è®¾æˆ‘ä»¬æœ‰ 5,000,000 ä¸ªæ•°æ®ï¼Œæ¯ 1000 ä½œä¸ºä¸€ä¸ªé›†åˆï¼Œè®¡å…¥ä¸Šé¢æ‰€æåˆ°çš„ $x^{\\{1\\}}=\\{x^{(1)},x^{(2)}â€¦â€¦x^{(5000)}\\},â€¦â€¦$

> 1. éœ€è¦è¿­ä»£è¿è¡Œ 5000æ¬¡ ç¥ç»ç½‘ç»œè¿ç®—.
> 2. æ¯ä¸€æ¬¡è¿­ä»£å…¶å®ä¸ä¹‹å‰ç¬”è®°ä¸­æ‰€æåˆ°çš„è®¡ç®—è¿‡ç¨‹ä¸€æ ·ï¼Œé¦–å…ˆæ˜¯å‰å‘ä¼ æ’­ï¼Œä½†æ˜¯æ¯æ¬¡è®¡ç®—çš„æ•°é‡æ˜¯ 1000.
> 3. è®¡ç®—æŸå¤±å‡½æ•°ï¼Œå¦‚æœæœ‰ Regularization ï¼Œåˆ™è®°å¾—åŠ ä¸Š Regularization Item
> 4. Backward propagation
> 
> æ³¨æ„ï¼Œmini-batch ç›¸æ¯”äºä¹‹å‰ä¸€æ¬¡æ€§è®¡ç®—æ‰€æœ‰æ•°æ®ä¸ä»…é€Ÿåº¦å¿«ï¼Œè€Œä¸”åå‘ä¼ æ’­éœ€è¦è®¡ç®— 5000æ¬¡ï¼Œæ‰€ä»¥æ•ˆæœä¹Ÿæ›´å¥½.

epoch

> - å¯¹äºæ™®é€šçš„æ¢¯åº¦ä¸‹é™æ³•ï¼Œä¸€ä¸ª epoch åªèƒ½è¿›è¡Œä¸€æ¬¡æ¢¯åº¦ä¸‹é™ï¼›
> - å¯¹äº Mini-batch æ¢¯åº¦ä¸‹é™æ³•ï¼Œä¸€ä¸ª epoch å¯ä»¥è¿›è¡Œ Mini-batch çš„ä¸ªæ•°æ¬¡æ¢¯åº¦ä¸‹é™;

> **epoch** : å½“ä¸€ä¸ª`å®Œæ•´çš„æ•°æ®é›†`é€šè¿‡äº†ç¥ç»ç½‘ç»œä¸€æ¬¡å¹¶ä¸”è¿”å›äº†ä¸€æ¬¡ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºä¸€ä¸ª epochã€‚
> 
> æ¯”å¦‚å¯¹äºä¸€ä¸ªæœ‰ 2000 ä¸ªè®­ç»ƒæ ·æœ¬çš„æ•°æ®é›†ã€‚å°† 2000 ä¸ªæ ·æœ¬åˆ†æˆå¤§å°ä¸º 500 çš„ batchï¼Œé‚£ä¹ˆå®Œæˆä¸€ä¸ª epoch éœ€è¦ 4 ä¸ª iterationã€‚

### ä¸åŒ size å¤§å°çš„æ¯”è¾ƒ

æ™®é€šçš„ batch æ¢¯åº¦ä¸‹é™æ³• å’Œ Mini-batchæ¢¯åº¦ä¸‹é™æ³• ä»£ä»·å‡½æ•°çš„å˜åŒ–è¶‹åŠ¿ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

{% image "/images/deeplearning/C2W2-3_1.png", width="700px" %}

**Batchæ¢¯åº¦ä¸‹é™** ï¼ˆå¦‚ä¸‹å›¾ä¸­è“è‰²ï¼‰:

> - å¯¹æ‰€æœ‰ m ä¸ªè®­ç»ƒæ ·æœ¬æ‰§è¡Œä¸€æ¬¡æ¢¯åº¦ä¸‹é™ï¼Œæ¯ä¸€æ¬¡è¿­ä»£æ—¶é—´è¾ƒé•¿ï¼›
> - Cost function æ€»æ˜¯å‘å‡å°çš„æ–¹å‘ä¸‹é™ã€‚

> è¯´æ˜: mini-batch size = mï¼Œæ­¤æ—¶å³ä¸º Batch gradient descent $(x^{\{t\}},y^{\{t\}})=(X,Y)$

**éšæœºæ¢¯åº¦ä¸‹é™** ï¼ˆå¦‚ä¸‹å›¾ä¸­ç´«è‰²ï¼‰:

> -å¯¹æ¯ä¸€ä¸ªè®­ç»ƒæ ·æœ¬æ‰§è¡Œä¸€æ¬¡æ¢¯åº¦ä¸‹é™ï¼Œä½†æ˜¯ä¸¢å¤±äº†å‘é‡åŒ–å¸¦æ¥çš„è®¡ç®—åŠ é€Ÿï¼›
> - Cost function æ€»ä½“çš„è¶‹åŠ¿å‘æœ€å°å€¼çš„æ–¹å‘ä¸‹é™ï¼Œä½†æ˜¯æ— æ³•åˆ°è¾¾å…¨å±€æœ€å°å€¼ç‚¹ï¼Œå‘ˆç°æ³¢åŠ¨çš„å½¢å¼.

> è¯´æ˜: mini-batch size = 1ï¼Œæ­¤æ—¶å³ä¸º Stochastic gradient descent $(x^{\\{t\\}},y^{\\{t\\}})=(x^{(i)},y^{(i)})$

**Mini-batchæ¢¯åº¦ä¸‹é™** ï¼ˆå¦‚ä¸‹å›¾ä¸­ç»¿è‰²ï¼‰:

> - é€‰ä¸€ä¸ª $1<size<m$ çš„åˆé€‚çš„ size è¿›è¡Œ Mini-batch æ¢¯åº¦ä¸‹é™ï¼Œå¯å®ç°å¿«é€Ÿå­¦ä¹ ï¼Œä¹Ÿåº”ç”¨äº†å‘é‡åŒ–å¸¦æ¥çš„å¥½å¤„
> - Cost function çš„ä¸‹é™å¤„äºå‰ä¸¤è€…ä¹‹é—´

{% image "/images/deeplearning/C2W2-4_1.png", width="700px" %}

### Mini-batch å¤§å°çš„é€‰æ‹©

> - å¦‚æœè®­ç»ƒæ ·æœ¬çš„å¤§å°æ¯”è¾ƒå°æ—¶ï¼Œå¦‚ $mâ©½2000$ æ—¶ â€” é€‰æ‹© batch æ¢¯åº¦ä¸‹é™æ³•ï¼›
> - å¦‚æœè®­ç»ƒæ ·æœ¬çš„å¤§å°æ¯”è¾ƒå¤§æ—¶ï¼Œå…¸å‹çš„å¤§å°ä¸ºï¼š$2^{6}ã€2^{7}ã€\cdotsã€2^{10}$
> - Mini-batch çš„å¤§å°è¦ç¬¦åˆ CPU/GPU å†…å­˜ï¼Œ è¿ç®—èµ·æ¥ä¼šæ›´å¿«ä¸€äº›.

## 2. Exponentially weighted averages

ä¸ºäº†ç†è§£åé¢ä¼šæåˆ°çš„å„ç§ä¼˜åŒ–ç®—æ³•ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°æŒ‡æ•°åŠ æƒå¹³å‡ï¼Œåœ¨ç»Ÿè®¡å­¦ä¸­ä¹Ÿå«åšæŒ‡æ•°åŠ æƒç§»åŠ¨å¹³å‡.

æŒ‡æ•°åŠ æƒå¹³å‡çš„å…³é”®å‡½æ•°ï¼š 

$$
v\_{t} = \beta v\_{t-1}+(1-\beta)\theta\_{t}
$$

é¦–å…ˆæˆ‘ä»¬å‡è®¾æœ‰ä¸€å¹´çš„æ¸©åº¦æ•°æ®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º

{% image "/images/deeplearning/C2W2-5_0.jpg", width="500px" %}

æˆ‘ä»¬ç°åœ¨éœ€è¦è®¡ç®—å‡ºä¸€ä¸ªæ¸©åº¦è¶‹åŠ¿æ›²çº¿ï¼Œè®¡ç®—æ–¹æ³•(`æŒ‡æ•°åŠ æƒå¹³å‡å®ç°`)å¦‚ä¸‹ï¼š

$$
v\_{0} =0 \\\\
v\_{1}= \beta v\_{0}+(1-\beta)\theta\_{1} \\\\
v\_{2}= \beta v\_{1}+(1-\beta)\theta\_{2} \\\\
v\_{3}= \beta v\_{2}+(1-\beta)\theta\_{3} \\\\
\ldots
$$

> ä¸Šé¢çš„ $Î¸\_t$ è¡¨ç¤ºç¬¬ $t$ å¤©çš„æ¸©åº¦ï¼ŒÎ² æ˜¯å¯è°ƒèŠ‚çš„å‚æ•°ï¼Œ$V\_t$ è¡¨ç¤º $\frac{1}{1-Î²}$ å¤©çš„æ¯æ—¥æ¸©åº¦

<!--ä¸‹å›¾æ˜¯ä¸€ä¸ªå…³äºå¤©æ•°å’Œæ¸©åº¦çš„æ•£ç‚¹å›¾ï¼š
{% image "/images/deeplearning/C2W2-5_1.png", width="600px" %}
-->

### å½“ Î²=0.9ã€0.98ã€0.5 çš„æƒ…å†µ

å½“ Î²=0.9 æ—¶ï¼ŒæŒ‡æ•°åŠ æƒå¹³å‡æœ€åçš„ç»“æœå¦‚ä¸‹å›¾ä¸­**çº¢è‰²**çº¿æ‰€ç¤ºï¼›

{% image "/images/deeplearning/C2W2-5_2.jpg", width="600px" %}

å½“ Î²=0.98 æ—¶ï¼ŒæŒ‡æ•°åŠ æƒå¹³å‡æœ€åçš„ç»“æœå¦‚ä¸‹å›¾ä¸­**ç»¿è‰²**çº¿æ‰€ç¤º, ç»¿çº¿ç›¸æ¯”è¾ƒçº¢çº¿è¦å¹³æ»‘ä¸€äº›ï¼Œæ˜¯å› ä¸ºå¯¹è¿‡å»æ¸©åº¦çš„æƒé‡æ›´å¤§ï¼Œæ‰€ä»¥å½“å¤©å¤©æ°”æ¸©åº¦çš„å½±å“é™ä½ï¼Œåœ¨æ¸©åº¦å˜åŒ–æ—¶ï¼Œé€‚åº”å¾—æ›´ç¼“æ…¢ä¸€äº›ï¼›

{% image "/images/deeplearning/C2W2-5_3.jpg", width="600px" %}

å½“ Î²=0.5 æ—¶ï¼ŒæŒ‡æ•°åŠ æƒå¹³å‡æœ€åçš„ç»“æœå¦‚ä¸‹å›¾ä¸­**é»„è‰²**çº¿æ‰€ç¤ºï¼›

{% image "/images/deeplearning/C2W2-5_4.jpg", width="600px" %}

<!--{% image "/images/deeplearning/C2W2-6_1.png", width="700px" %}
-->
>  Notes: The most common value for $\beta$ is 0.9.

### ç†è§£æŒ‡æ•°åŠ æƒå¹³å‡

ä¾‹å­ï¼Œå½“ Î²=0.9 æ—¶ï¼š 

$$
v\_{100} = 0.9v\_{99}+0.1\theta\_{100} \\\\ v\_{99} = 0.9v\_{98}+0.1\theta\_{99} \\\\ v\_{98} = 0.9v\_{97}+0.1\theta\_{98} \\\\
\ldots
$$

å±•å¼€ï¼š

$$
v\_{100}=0.1\theta\_{100}+0.9(0.1\theta\_{99}+0.9(0.1\theta\_{98}+0.9v\_{97})) \\\\ v\_{100}=0.1\theta\_{100}+0.1\times0.9\theta\_{99}+0.1\times(0.9)^{2}\theta\_{98}+0.1\times(0.9)^{3}\theta\_{97}+\cdots
$$

ä¸Šå¼ä¸­æ‰€æœ‰ $Î¸$ å‰é¢çš„ç³»æ•°ç›¸åŠ èµ·æ¥ä¸º 1 æˆ–è€… æ¥è¿‘äº 1ï¼Œç§°ä¹‹ä¸ºåå·®ä¿®æ­£.

> æ€»ä½“æ¥è¯´å­˜åœ¨ï¼Œ$(1-\varepsilon)^{1/\varepsilon}=\dfrac{1}{e}$, åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œ$1-\varepsilon=\beta=0.9$, å³ $0.9^{10}\approx 0.35\approx\dfrac{1}{e}$ . ç›¸å½“äºå¤§çº¦10å¤©åï¼Œç³»æ•°çš„å³°å€¼ï¼ˆè¿™é‡Œæ˜¯0.1ï¼‰ä¸‹é™åˆ°åŸæ¥çš„ $\dfrac{1}{e}$ï¼Œåªå…³æ³¨äº†è¿‡å»10å¤©çš„å¤©æ°”.

### æŒ‡æ•°åŠ æƒå¹³å‡çš„åå·®ä¿®æ­£ Bias correction

åœ¨æˆ‘ä»¬æ‰§è¡ŒæŒ‡æ•°åŠ æƒå¹³å‡çš„å…¬å¼æ—¶ï¼Œå½“ Î²=0.98 æ—¶ï¼Œå¾—åˆ°çš„å¹¶ä¸æ˜¯å›¾ä¸­çš„**ç»¿è‰²**æ›²çº¿ï¼Œè€Œæ˜¯ä¸‹å›¾ä¸­çš„**ç´«è‰²**æ›²çº¿ï¼Œå…¶èµ·ç‚¹æ¯”è¾ƒä½ã€‚

{% image "/images/deeplearning/C2W2-7.png", width="650px" %}

**åŸå› **ï¼š 

> $$
v\_{0}=0\\\\v\_{1}=0.98v\_{0}+0.02\theta\_{1}=0.02\theta\_{1}\\\\v\_{2}=0.98v\_{1}+0.02\theta\_{2}=0.98\times0.02\theta\_{1}+0.02\theta\_{2}=0.0196\theta\_{1}+0.02\theta\_{2}
$$

> å¦‚æœç¬¬ä¸€å¤©çš„å€¼ä¸ºå¦‚40ï¼Œåˆ™å¾—åˆ°çš„ v1=0.02Ã—40=0.8ï¼Œåˆ™å¾—åˆ°çš„å€¼è¦è¿œå°äºå®é™…å€¼ï¼Œåé¢å‡ å¤©çš„æƒ…å†µä¹Ÿä¼šç”±äºåˆå€¼å¼•èµ·çš„å½±å“ï¼Œå‡ä½äºå®é™…å‡å€¼.

**åå·®ä¿®æ­£**ï¼š 

> ä½¿ç”¨ $\dfrac{v\_{t}}{1-\beta^{t}}$

> - å½“ t=2 æ—¶ï¼š

> $$
1-\beta^{t}=1-(0.98)^{2}=0.0396
$$

> $$
\dfrac{v\_{2}}{0.0396}=\dfrac{0.0196\theta\_{1}+0.02\theta\_{2}}{0.0396}
$$
> 
> åå·®ä¿®æ­£å¾—åˆ°äº†ç»¿è‰²çš„æ›²çº¿ï¼Œåœ¨å¼€å§‹çš„æ—¶å€™ï¼Œèƒ½å¤Ÿå¾—åˆ°æ¯”ç´«è‰²æ›²çº¿æ›´å¥½çš„è®¡ç®—å¹³å‡çš„æ•ˆæœã€‚éšç€ t é€æ¸å¢å¤§ï¼Œ$\beta^{t}$ æ¥è¿‘äº 0ï¼Œæ‰€ä»¥åé¢ç»¿è‰²çš„æ›²çº¿å’Œç´«è‰²çš„æ›²çº¿é€æ¸é‡åˆäº†.
>
> è™½ç„¶å­˜åœ¨è¿™ç§é—®é¢˜ï¼Œä½†æ˜¯åœ¨å®é™…è¿‡ç¨‹ä¸­ï¼Œä¸€èˆ¬ä¼šå¿½ç•¥å‰æœŸå‡å€¼åå·®çš„å½±å“

**åå·®ä¿®æ­£ ä¸¾ä¸ªğŸŒ°, ä»¥ä¾¿äºå¤§å®¶ç†è§£:**

> é¦–å…ˆæˆ‘ä»¬å‡è®¾çš„æ˜¯ $Î²=0.98, V\_0=0$, ç„¶åç”± $V\_t=Î²V\_{t-1}+(1-Î²)Î¸\_t$ å¯çŸ¥
>
> - $V\_1=0.98V\_0+0.02Î¸\_1=0.02Î¸\_1$
>
> - $V\_2=0.98V\_1+0.02Î¸\_2=0.0196Î¸\_1+0.02Î¸\_2$
>
> å½“è¿›è¡ŒæŒ‡æ•°åŠ æƒå¹³å‡è®¡ç®—æ—¶ï¼Œç¬¬ä¸€ä¸ªå€¼ $v\_0$ è¢«åˆå§‹åŒ–ä¸º 0ï¼Œè¿™æ ·å°†åœ¨å‰æœŸçš„è¿ç®—ç”¨äº§ç”Ÿä¸€å®šçš„åå·®ã€‚ä¸ºäº†çŸ«æ­£åå·®ï¼Œéœ€è¦åœ¨æ¯ä¸€æ¬¡è¿­ä»£åè¿›è¡Œåå·®ä¿®æ­£ï¼ˆBias Correctionï¼‰
> 
> å‡è®¾ $Î¸\_1=40â„ƒ$,é‚£ä¹ˆ $V\_1=0.02*40=0.8â„ƒ$ï¼Œè¿™æ˜¾ç„¶ç›¸å·®å¤ªå¤§ï¼ŒåŒç†å¯¹äºåé¢çš„æ¸©åº¦çš„è®¡ç®—ä¹Ÿåªä¼šæ˜¯å˜å·®è¶Šæ¥è¶Šå¤§. æ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›è¡Œåå·®ä¿®æ­£ï¼Œå…·ä½“æ–¹æ³•å¦‚ä¸‹ï¼š
>
> $$
V\_t=\frac{Î²V\_{t-1}+(1-Î²)Î¸\_t}{1-Î²^t}
$$
>
> æ³¨æ„ ï¼šï¼ï¼ï¼ä¸Šé¢å…¬å¼ä¸­çš„ $V\_{t-1}$ æ˜¯æœªä¿®æ­£çš„å€¼.
> 
> ä¸ºæ–¹ä¾¿è¯´æ˜ï¼Œä»¤ $Î²=0.98,Î¸\_1=40â„ƒ,Î¸\_2=39â„ƒ$, åˆ™
> 
> - å½“ $t=1,Î¸\_1=40â„ƒ$ æ—¶ï¼Œ$V\_1=\frac{0.02*40}{1-0.98}=40$ ,å“‡å“¦, æœ‰æ²¡æœ‰å¾ˆå·§çš„æ„Ÿè§‰ï¼Œå†çœ‹
> - å½“ $t=2,Î¸\_2=39â„ƒ$ æ—¶ï¼Œ$V\_2 = \frac{0.98\*V\_{t-1} + 0.02\*Î¸\_2}{1-0.98^2}$ $=\frac{0.98\*(0 + 0.02\*Î¸\_1)+0.02\*39}{1-0.98^2}=39.49$
> 
> `æ³¨æ„ç‚¹` : æ‰€ä»¥ï¼Œ**è®°ä½ä½ å¦‚æœç›´æ¥ç”¨ä¿®æ­£åçš„ $V\_{tâˆ’1}$ å€¼ä»£å…¥è®¡ç®—å°±å¤§é”™ç‰¹é”™äº†**.

## 3. Momentum

åŠ¨é‡æ¢¯åº¦ä¸‹é™çš„åŸºæœ¬æ€æƒ³å°±æ˜¯`è®¡ç®—æ¢¯åº¦çš„æŒ‡æ•°åŠ æƒå¹³å‡æ•°`ï¼Œå¹¶åˆ©ç”¨è¯¥æ¢¯åº¦æ¥æ›´æ–°æƒé‡

### Momentum è§£é‡Šç‰ˆ

é€šå¸¸æƒ…å†µæˆ‘ä»¬åœ¨è®­ç»ƒæ·±åº¦ç¥ç»ç½‘ç»œçš„æ—¶å€™æŠŠæ•°æ®æ‹†è§£æˆä¸€å°æ‰¹ä¸€å°æ‰¹åœ°è¿›è¡Œè®­ç»ƒï¼Œè¿™å°±æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„ mini-batch SGD è®­ç»ƒç®—æ³•ï¼Œç„¶è€Œè™½ç„¶è¿™ç§ç®—æ³•èƒ½å¤Ÿå¸¦æ¥å¾ˆå¥½çš„è®­ç»ƒé€Ÿåº¦ï¼Œä½†æ˜¯åœ¨åˆ°è¾¾æœ€ä¼˜ç‚¹çš„æ—¶å€™å¹¶ä¸èƒ½å¤Ÿæ€»æ˜¯çœŸæ­£åˆ°è¾¾æœ€ä¼˜ç‚¹ï¼Œè€Œæ˜¯åœ¨æœ€ä¼˜ç‚¹é™„è¿‘å¾˜å¾Šã€‚å¦ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯è¿™ç§ç®—æ³•éœ€è¦æˆ‘ä»¬æŒ‘é€‰ä¸€ä¸ªåˆé€‚çš„å­¦ä¹ ç‡ï¼Œå½“æˆ‘ä»¬é‡‡ç”¨å°çš„å­¦ä¹ ç‡çš„æ—¶å€™ï¼Œä¼šå¯¼è‡´ç½‘ç»œåœ¨è®­ç»ƒçš„æ—¶å€™æ”¶æ•›å¤ªæ…¢ï¼›å½“æˆ‘ä»¬é‡‡ç”¨å¤§çš„å­¦ä¹ ç‡çš„æ—¶å€™ï¼Œä¼šå¯¼è‡´åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¼˜åŒ–çš„å¹…åº¦è·³è¿‡å‡½æ•°çš„èŒƒå›´ï¼Œä¹Ÿå°±æ˜¯å¯èƒ½è·³è¿‡æœ€ä¼˜ç‚¹ã€‚æˆ‘ä»¬æ‰€å¸Œæœ›çš„ä»…ä»…æ˜¯ç½‘ç»œåœ¨ä¼˜åŒ–çš„æ—¶å€™ç½‘ç»œçš„æŸå¤±å‡½æ•°æœ‰ä¸€ä¸ªå¾ˆå¥½çš„æ”¶æ•›é€Ÿåº¦åŒæ—¶åˆä¸è‡³äºæ‘†åŠ¨å¹…åº¦å¤ªå¤§ã€‚

æ‰€ä»¥ Momentum ä¼˜åŒ–å™¨ åˆšå¥½å¯ä»¥è§£å†³æˆ‘ä»¬æ‰€é¢ä¸´çš„é—®é¢˜ï¼Œå®ƒä¸»è¦æ˜¯åŸºäºæ¢¯åº¦çš„ç§»åŠ¨æŒ‡æ•°åŠ æƒå¹³å‡ã€‚å‡è®¾åœ¨å½“å‰çš„è¿­ä»£æ­¥éª¤ç¬¬ t æ­¥ä¸­ï¼Œé‚£ä¹ˆåŸºäº Momentum ä¼˜åŒ–ç®—æ³• å¯ä»¥å†™æˆä¸‹é¢çš„å…¬å¼ï¼š 

$$
{v\_\{dw\}} = \beta {v\_\{dw\}} + (1 - \beta )dW \\\\ {v\_{db}} = \beta {v\_{db}} + (1 - \beta )db \\\\ W = W - \alpha {v\_{dw}} \\\\ b = b - \alpha {v\_{db}}
$$

> [å¼•ç”¨çŸ¥ä¹æœºå™¨å­¦ä¹ å°èœé¸Ÿçš„æµæ°´è´¦][7] ï¼š
>
> åŠ¨é‡æ¢¯åº¦ä¸‹é™ä¸æ¢¯åº¦ä¸‹é™ç›¸æ¯”ï¼Œå°±æ˜¯å¯¹æ¢¯åº¦ä½¿ç”¨æŒ‡æ•°åŠ æƒå¹³å‡ï¼Œå…¶ä»–çš„éƒ½ä¿å­˜ä¸€è‡´ã€‚
> 
> dw ä¸ db è¡¨ç¤ºæœ¬æ¬¡è¿­ä»£çš„æ¢¯åº¦ï¼ŒVdw å’Œ Vdb è¡¨ç¤ºæŒ‡æ•°åŠ æƒå¹³å‡çš„æ¢¯åº¦ã€‚
> 
> å¦‚æœä¸ç”¨æŒ‡æ•°åŠ æƒå¹³å‡çš„è¯ï¼Œæ¯æ¬¡è¿­ä»£æ›´æ–°ä½¿ç”¨çš„æ¢¯åº¦éƒ½åªä¸æœ¬æ¬¡è¿­ä»£çš„æ ·æœ¬æœ‰å…³ï¼Œæ¯æ¬¡è¿­ä»£çš„æ ·æœ¬æœ‰å¥½æœ‰åï¼Œä¼šä½¿è¿­ä»£æ¥è¿‘æœ€å°å€¼çš„ä¸æ–­æ³¢åŠ¨ï¼Œå¯¼è‡´ä¸‹é™é€Ÿåº¦æ…¢ã€‚åŠ å…¥æŒ‡æ•°åŠ æƒå¹³å‡åï¼Œæœ¬æ¬¡æ¢¯åº¦å½±å“å‡å°‘ï¼Œæ³¢åŠ¨æƒ…å†µä¹Ÿå°±ä¼šå‡å°ï¼Œç›´è§‚ä¸Šé¢ç†è§£å°±æ˜¯å·¦å³æ³¢åŠ¨æŠµæ¶ˆï¼Œé‚£ä¹ˆä¸‹é™é€Ÿåº¦ä¹Ÿå°±è‡ªç„¶æ›´å¿«ã€‚åŠ¨é‡æ¢¯åº¦ä¸‹é™æ¯”æ¢¯åº¦ä¸‹é™æ”¶æ•›é€Ÿåº¦è¦å¿«ã€‚
> 
> ç‰©ç†æ„ä¹‰ç†è§£ï¼šåœ¨ä¸‹é™çš„è¿‡ç¨‹ä¸­ï¼Œ $(1 - \beta )dW$ ç›¸å½“äºåŠ é€Ÿåº¦ï¼Œ $\beta {v\_\{dw\}}$ ç›¸å½“äºæ‘©æ“¦ï¼ŒåŠ é€Ÿåº¦å¯ä»¥æ˜¯ä¸‹é™åŠ å¿«ï¼Œè€Œæ‘©æ“¦ä¸ä¼šè®©åŠ é€Ÿä¸€ç›´è¿›è¡Œä¸‹å»ã€‚ï¼ˆä¸æ˜¯å¾ˆç†è§£ï¼‰


---

> åœ¨ä¸Šé¢çš„å…¬å¼ä¸­ ${v\_{dw}}$ å’Œ ${v\_{db}}$ åˆ†åˆ«æ˜¯æŸå¤±å‡½æ•°åœ¨å‰ $tâˆ’1$ è½®è¿­ä»£è¿‡ç¨‹ä¸­ç´¯ç§¯çš„æ¢¯åº¦æ¢¯åº¦åŠ¨é‡ï¼Œ$\beta$ æ˜¯æ¢¯åº¦ç´¯ç§¯çš„ä¸€ä¸ªæŒ‡æ•°ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸€èˆ¬è®¾ç½®å€¼ä¸º 0.9ã€‚æ‰€ä»¥ Momentum ä¼˜åŒ–å™¨ çš„ä¸»è¦æ€æƒ³å°±æ˜¯åˆ©ç”¨äº†ç±»ä¼¼ä¸ç§»åŠ¨æŒ‡æ•°åŠ æƒå¹³å‡çš„æ–¹æ³•æ¥å¯¹ç½‘ç»œçš„å‚æ•°è¿›è¡Œå¹³æ»‘å¤„ç†çš„ï¼Œè®©æ¢¯åº¦çš„æ‘†åŠ¨å¹…åº¦å˜å¾—æ›´å°ã€‚ 
>
> dW å’Œ db åˆ†åˆ«æ˜¯æŸå¤±å‡½æ•°åå‘ä¼ æ’­æ—¶å€™æ‰€æ±‚å¾—çš„æ¢¯åº¦ï¼Œä¸‹é¢ä¸¤ä¸ªå…¬å¼æ˜¯ç½‘ç»œæƒé‡å‘é‡å’Œåç½®å‘é‡çš„æ›´æ–°å…¬å¼ï¼ŒÎ± æ˜¯ç½‘ç»œçš„å­¦ä¹ ç‡ã€‚å½“æˆ‘ä»¬ä½¿ç”¨ Momentumä¼˜åŒ–ç®—æ³•çš„æ—¶å€™ï¼Œå¯ä»¥è§£å†³ mini-batch SGD ä¼˜åŒ–ç®—æ³•æ›´æ–°å¹…åº¦æ‘†åŠ¨å¤§çš„é—®é¢˜ï¼ŒåŒæ—¶å¯ä»¥ä½¿å¾—ç½‘ç»œçš„æ”¶æ•›é€Ÿåº¦æ›´å¿«ã€‚

### Momentum è¯¦ç»†ç‰ˆ

åœ¨æˆ‘ä»¬ä¼˜åŒ– Cost function çš„æ—¶å€™ï¼Œä»¥ä¸‹å›¾æ‰€ç¤ºçš„å‡½æ•°å›¾ä¸ºä¾‹ï¼š

é¦–å…ˆä»‹ç»ä¸€ä¸‹ä¸€èˆ¬çš„æ¢¯åº¦ç®—æ³•æ”¶æ•›æƒ…å†µæ˜¯è¿™æ ·çš„

{% image "/images/deeplearning/C2W2-8_1.png", width="750px" %}

> å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å‰è¿›çš„é“è·¯ä¸Šååˆ†æ›²æŠ˜ï¼Œèµ°äº†ä¸å°‘å¼¯è·¯ï¼Œåœ¨çºµå‘æˆ‘ä»¬å¸Œæœ›èµ°å¾—æ…¢ä¸€ç‚¹ï¼Œæ¨ªå‘åˆ™å¸Œæœ›èµ°å¾—å¿«ä¸€ç‚¹ï¼Œæ‰€ä»¥æ‰æœ‰äº†åŠ¨é‡æ¢¯åº¦ä¸‹é™ç®—æ³•.

**Momentumç®—æ³•çš„ç¬¬ t æ¬¡è¿­ä»£ï¼š**

> - è®¡ç®—å‡º dw, db
> - è¿™ä¸ªè®¡ç®—å¼å­ä¸ä¸Šä¸€å±Šæåˆ°çš„æŒ‡æ•°åŠ æƒå¹³å‡æœ‰ç‚¹ç±»ä¼¼ï¼Œå³
> $ V\_{dw}=Î²V\_{dw}+(1-Î²)dw \\\\ V\_{db}=Î²V\_{db}+(1-Î²)db $
> - $W=W-Î±V\_{dw},b=b-Î±V\_{db}$

{% image "/images/deeplearning/C2W2-10_1.png", width="600px" %}

æœ€ç»ˆå¾—åˆ°æ”¶æ•›çš„æ•ˆæœå¦‚ä¸‹å›¾çš„çº¢è‰²æ›²çº¿æ‰€ç¤º.

{% image "/images/deeplearning/C2W2-9_1.png", width="750px" %}

åœ¨åˆ©ç”¨æ¢¯åº¦ä¸‹é™æ³•æ¥æœ€å°åŒ–è¯¥å‡½æ•°çš„æ—¶å€™ï¼Œæ¯ä¸€æ¬¡è¿­ä»£æ‰€æ›´æ–°çš„ä»£ä»·å‡½æ•°å€¼å¦‚å›¾ä¸­è“è‰²çº¿æ‰€ç¤ºåœ¨ä¸Šä¸‹æ³¢åŠ¨ï¼Œè€Œè¿™ç§å¹…åº¦æ¯”è¾ƒå¤§æ³¢åŠ¨ï¼Œå‡ç¼“äº†æ¢¯åº¦ä¸‹é™çš„é€Ÿåº¦ï¼Œè€Œä¸”æˆ‘ä»¬åªèƒ½ä½¿ç”¨ä¸€ä¸ªè¾ƒå°çš„å­¦ä¹ ç‡æ¥è¿›è¡Œè¿­ä»£.

å¦‚æœç”¨è¾ƒå¤§çš„å­¦ä¹ ç‡ï¼Œç»“æœå¯èƒ½ä¼šå¦‚ç´«è‰²çº¿ä¸€æ ·åç¦»å‡½æ•°çš„èŒƒå›´ï¼Œæ‰€ä»¥ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œåªèƒ½ç”¨è¾ƒå°çš„å­¦ä¹ ç‡.

> è¯¥ç®—æ³•ä¸­æ¶‰åŠåˆ°çš„è¶…å‚æ•°æœ‰ä¸¤ä¸ªï¼Œåˆ†åˆ«æ˜¯ Î±ï¼ŒÎ²ï¼Œå…¶ä¸­ä¸€èˆ¬ Î²=0.9 æ˜¯æ¯”è¾ƒå¸¸å–çš„å€¼
>
> - ä¸€èˆ¬å°†å‚æ•°è®¾ä¸º 0.5, 0.9ï¼Œæˆ–è€… 0.99ï¼Œåˆ†åˆ«è¡¨ç¤ºæœ€å¤§é€Ÿåº¦ 2å€ï¼Œ10å€ï¼Œ100å€ äº SGD çš„ç®—æ³•;
> - é€šè¿‡é€Ÿåº¦vï¼Œæ¥ç§¯ç´¯äº†ä¹‹é—´æ¢¯åº¦æŒ‡æ•°çº§è¡°å‡çš„å¹³å‡ï¼Œå¹¶ä¸”ç»§ç»­å»¶è¯¥æ–¹å‘ç§»åŠ¨;

å†çœ‹çœ‹ç®—æ³•ï¼š 

{% image "/images/deeplearning/C2W2-11.png", width="700px" %}

## 4. RMSprop (Root Mean Square Prop)

RMSProp ç®—æ³•çš„å…¨ç§°å« Root Mean Square Propï¼Œæ˜¯ Geoffrey E. Hinton åœ¨ Coursera è¯¾ç¨‹ä¸­æå‡ºçš„ä¸€ç§ä¼˜åŒ–ç®—æ³•ï¼Œåœ¨ä¸Šé¢çš„ Momentum ä¼˜åŒ–ç®—æ³•ä¸­ï¼Œè™½ç„¶åˆæ­¥è§£å†³äº†ä¼˜åŒ–ä¸­æ‘†åŠ¨å¹…åº¦å¤§çš„é—®é¢˜ã€‚æ‰€è°“çš„æ‘†åŠ¨å¹…åº¦å°±æ˜¯åœ¨ä¼˜åŒ–ä¸­ç»è¿‡æ›´æ–°ä¹‹åå‚æ•°çš„å˜åŒ–èŒƒå›´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ**è“è‰²çš„ä¸º Momentum ä¼˜åŒ–ç®—æ³•æ‰€èµ°çš„è·¯çº¿**ï¼Œ**ç»¿è‰²çš„ä¸º RMSProp ä¼˜åŒ–ç®—æ³•æ‰€èµ°çš„è·¯çº¿**ã€‚

{% image "/images/deeplearning/C2W2-12_1.png", width="700px" %}

ä¸ºäº†è¿›ä¸€æ­¥ä¼˜åŒ–æŸå¤±å‡½æ•°åœ¨æ›´æ–°ä¸­å­˜åœ¨æ‘†åŠ¨å¹…åº¦è¿‡å¤§çš„é—®é¢˜ï¼Œå¹¶ä¸”è¿›ä¸€æ­¥åŠ å¿«å‡½æ•°çš„æ”¶æ•›é€Ÿåº¦ï¼ŒRMSProp ç®—æ³•å¯¹æƒé‡ W å’Œåç½® b çš„æ¢¯åº¦ä½¿ç”¨äº†å¾®åˆ†å¹³æ–¹åŠ æƒå¹³å‡æ•°ã€‚ 

å…¶ä¸­ï¼Œå‡è®¾åœ¨ç¬¬ t è½®è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œå„ä¸ªå…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š

$$
{s\_{dw}} = \beta {s\_{dw}} + (1 - \beta )d{W^2} \\\\
{s\_{db}} = \beta {s\_{db}} + (1 - \beta )d{b^2}
$$

$$
W = W - \alpha \frac {dW} { \sqrt {s\_{dw}} + \varepsilon } \\\\
b = b - \alpha \frac {db} { \sqrt{s\_{db}}  + \varepsilon }
$$

> è¿™æ ·åšï¼Œèƒ½ç»™ä¿ç•™å¾®åˆ†å¹³æ–¹çš„åŠ æƒå¹³å‡æ•°
>
> ç®—æ³•çš„ä¸»è¦æ€æƒ³å°±ç”¨ä¸Šé¢çš„å…¬å¼è¡¨è¾¾å®Œæ¯•äº†ã€‚åœ¨ä¸Šé¢çš„å…¬å¼ä¸­ ${s\_{dw}}$ å’Œ ${s\_{db}}$ åˆ†åˆ«æ˜¯æŸå¤±å‡½æ•°åœ¨å‰ tâˆ’1 è½®è¿­ä»£è¿‡ç¨‹ä¸­ç´¯ç§¯çš„æ¢¯åº¦æ¢¯åº¦åŠ¨é‡ï¼ŒÎ² æ˜¯æ¢¯åº¦ç´¯ç§¯çš„ä¸€ä¸ªæŒ‡æ•°ã€‚æ‰€ä¸åŒçš„æ˜¯ï¼ŒRMSProp ç®—æ³•å¯¹æ¢¯åº¦è®¡ç®—äº†**å¾®åˆ†å¹³æ–¹åŠ æƒå¹³å‡æ•°**ã€‚è¿™ç§åšæ³•æœ‰åˆ©äºæ¶ˆé™¤äº†æ‘†åŠ¨å¹…åº¦å¤§çš„æ–¹å‘ï¼Œç”¨æ¥ä¿®æ­£æ‘†åŠ¨å¹…åº¦ï¼Œä½¿å¾—å„ä¸ªç»´åº¦çš„æ‘†åŠ¨å¹…åº¦éƒ½è¾ƒå°ã€‚å¦ä¸€æ–¹é¢ä¹Ÿä½¿å¾—ç½‘ç»œå‡½æ•°æ”¶æ•›æ›´å¿«ã€‚ï¼ˆæ¯”å¦‚å½“ dW æˆ–è€… db ä¸­æœ‰ä¸€ä¸ªå€¼æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨æ›´æ–°æƒé‡æˆ–è€…åç½®çš„æ—¶å€™é™¤ä»¥å®ƒä¹‹å‰ç´¯ç§¯çš„æ¢¯åº¦çš„å¹³æ–¹æ ¹ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿å¾—æ›´æ–°å¹…åº¦å˜å°ï¼‰ã€‚ä¸ºäº†é˜²æ­¢åˆ†æ¯ä¸ºé›¶ï¼Œä½¿ç”¨äº†ä¸€ä¸ªå¾ˆå°çš„æ•°å€¼ $\epsilon$ æ¥è¿›è¡Œå¹³æ»‘ï¼Œä¸€èˆ¬å–å€¼ä¸º $10^{-8}$ã€‚

## 5. Adam (Adaptive Moment Estimation)

æœ‰äº†ä¸Šé¢ä¸¤ç§ä¼˜åŒ–ç®—æ³•ï¼Œä¸€ç§å¯ä»¥ä½¿ç”¨ç±»ä¼¼äºç‰©ç†ä¸­çš„åŠ¨é‡æ¥ç´¯ç§¯æ¢¯åº¦ï¼Œå¦ä¸€ç§å¯ä»¥ä½¿å¾—æ”¶æ•›é€Ÿåº¦æ›´å¿«åŒæ—¶ä½¿å¾—æ³¢åŠ¨çš„å¹…åº¦æ›´å°ã€‚é‚£ä¹ˆè®²ä¸¤ç§ç®—æ³•ç»“åˆèµ·æ¥æ‰€å–å¾—çš„è¡¨ç°ä¸€å®šä¼šæ›´å¥½ã€‚Adamï¼ˆAdaptive Moment Estimationï¼‰ç®—æ³•æ˜¯å°† Momentumç®—æ³• å’Œ RMSPropç®—æ³• ç»“åˆèµ·æ¥ä½¿ç”¨çš„ä¸€ç§ç®—æ³•ï¼Œæˆ‘ä»¬æ‰€ä½¿ç”¨çš„å‚æ•°åŸºæœ¬å’Œä¸Šé¢è®²çš„ä¸€è‡´ï¼Œåœ¨è®­ç»ƒçš„æœ€å¼€å§‹æˆ‘ä»¬éœ€è¦åˆå§‹åŒ–æ¢¯åº¦çš„ç´¯ç§¯é‡å’Œå¹³æ–¹ç´¯ç§¯é‡ã€‚ 

$$
{v\_{dw}} = 0,{v\_{db}} = 0;{s\_{dw}} = 0,{s\_{db}} = 0
$$

å‡è®¾åœ¨è®­ç»ƒçš„ç¬¬ $t$ è½®è®­ç»ƒä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¯ä»¥è®¡ç®—å¾—åˆ° Momentum å’Œ RMSProp çš„å‚æ•°æ›´æ–°ï¼š 

$$
{v\_{dw}} = {\beta \_1}{v\_{dw}} + (1 - {\beta \_1})dW \\\\
{v\_{db}} = {\beta \_1}{v\_{db}} + (1 - {\beta \_1})db \\\\
{s\_{dw}} = {\beta \_2}{s\_{dw}} + (1 - {\beta \_2})d{W^2} \\\\
{s\_{db}} = {\beta \_2}{s\_{db}} + (1 - {\beta \_2})d{b^2} \\\\
$$

ç”±äºç§»åŠ¨æŒ‡æ•°å¹³å‡åœ¨è¿­ä»£å¼€å§‹çš„åˆæœŸä¼šå¯¼è‡´å’Œå¼€å§‹çš„å€¼æœ‰è¾ƒå¤§çš„å·®å¼‚ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹ä¸Šé¢æ±‚å¾—çš„å‡ ä¸ªå€¼åšåå·®ä¿®æ­£

$$
v\_{dw}^c = \frac {v\_{dw}} {1 - \beta \_1^t} \\\\
v\_{db}^c = \frac {v\_{db}} {1 - \beta \_1^t} \\\\
s\_{dw}^c = \frac {s\_{dw}} {1 - \beta \_2^t} \\\\
s\_{db}^c = \frac {s\_{db}} {1 - \beta \_2^t}
$$

é€šè¿‡ä¸Šé¢çš„å…¬å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ±‚å¾—åœ¨ç¬¬ $t$ è½®è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œå‚æ•°æ¢¯åº¦ç´¯ç§¯é‡çš„ä¿®æ­£å€¼ï¼Œä»è€Œæ¥ä¸‹æ¥å°±å¯ä»¥æ ¹æ® Momentum å’Œ RMSProp ç®—æ³•çš„ç»“åˆæ¥å¯¹æƒé‡å’Œåç½®è¿›è¡Œæ›´æ–°.

$$
W = W - \alpha \frac {v\_{dw}^c} {\sqrt {s\_{dw}^c}  + \varepsilon } \\\\
b = b - \alpha \frac {v\_{db}^c} {\sqrt {s\_{db}^c}  + \varepsilon }
$$

ä¸Šé¢çš„æ‰€æœ‰æ­¥éª¤å°±æ˜¯Momentumç®—æ³•å’ŒRMSPropç®—æ³•ç»“åˆèµ·æ¥ä»è€Œå½¢æˆAdamç®—æ³•ã€‚åœ¨Adamç®—æ³•ä¸­ï¼Œå‚æ•° ${\beta\_1}$ æ‰€å¯¹åº”çš„å°±æ˜¯Momentumç®—æ³•ä¸­çš„ ${\beta}$ å€¼ï¼Œä¸€èˆ¬å–0.9ï¼Œå‚æ•° ${\beta\_2}$ æ‰€å¯¹åº”çš„å°±æ˜¯RMSPropç®—æ³•ä¸­çš„ ${\beta}$ å€¼ï¼Œä¸€èˆ¬æˆ‘ä»¬å–0.999ï¼Œè€Œ $\epsilon$ æ˜¯ä¸€ä¸ªå¹³æ»‘é¡¹ï¼Œæˆ‘ä»¬ä¸€èˆ¬å–å€¼ä¸º ${10^{ - 8}}$ï¼Œè€Œå­¦ä¹ ç‡ $\alpha$ åˆ™éœ€è¦æˆ‘ä»¬åœ¨è®­ç»ƒçš„æ—¶å€™è¿›è¡Œå¾®è°ƒã€‚

> é€šè¿‡ä¸Šé¢çš„ä¸‰ä¸ªç®—æ³•åŸºæœ¬è®²è¿°äº†ç¥ç»ç½‘ç»œä¸­çš„ä¼˜åŒ–å™¨ï¼Œç†è§£äº†è¿™ä¸‰ä¸ªç®—æ³•å…¶ä»–çš„ç®—æ³•ä¹Ÿå°±å¼•åˆƒè€Œè§£äº†.
> 
> Adam ä¼˜åŒ–ç®—æ³• æˆ‘ä¼šæ¯«ä¸çŠ¹è±«çš„æ¨èç»™ä½ ï¼Œ å®ƒæ˜¯ Momentum å’Œ RMSprop çš„ç»“åˆ. äº‹å®è¯æ˜ï¼Œå®ƒå…¶å®è§£å†³äº†å¾ˆå¤šé—®é¢˜. 
> 
> Adam ä¸­çš„è¶…å‚æ•° ${\beta\_1}$ ã€${\beta\_2}$  ä¸€èˆ¬ä¸éœ€è¦è°ƒæ•´ï¼Œä¸šå†…ç»å¸¸å¾ˆå°‘æœ‰äººä¼šè°ƒæ•´ä»–ä»¬.  $\epsilon$ æ˜¯ä¸€ä¸ªå¹³æ»‘é¡¹ï¼Œä¸€èˆ¬å–å€¼ä¸º ${10^{ - 8}}$, åŸºæœ¬æ›´ä¸éœ€è¦è°ƒæ•´.

Adaptive Moment Estimation

> ${\beta\_1}$ ç”¨äºè®¡ç®—è¿™ä¸ªå¾®åˆ† (computing the mean of the derivatives, this is called the first moment).
> 
> ${\beta\_2}$ ç”¨äºè®¡ç®—å¹³æ–¹æ•°çš„æŒ‡æ•°åŠ æƒå¹³å‡æ•° (compute exponentially weighted average of the squares. this is called the second moment)
> 
> So that gives rise to the name `Adaptive Moment Estimation`.

## 6. Learning rate decay

ä¹‹å‰ç®—æ³•ä¸­æåˆ°çš„å­¦ä¹ ç‡Î±éƒ½æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œè¿™æ ·æœ‰å¯èƒ½ä¼šä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åˆšå¼€å§‹æ”¶æ•›é€Ÿåº¦åˆšåˆšå¥½ï¼Œå¯æ˜¯åœ¨åé¢æ”¶æ•›è¿‡ç¨‹ä¸­å­¦ä¹ ç‡åå¤§ï¼Œå¯¼è‡´ä¸èƒ½å®Œå…¨æ”¶æ•›ï¼Œè€Œæ˜¯åœ¨æœ€ä½ç‚¹æ¥å›æ³¢åŠ¨ã€‚æ‰€ä»¥ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦è®©å­¦ä¹ ç‡èƒ½å¤Ÿéšç€è¿­ä»£æ¬¡æ•°çš„å¢åŠ è¿›è¡Œè¡°å‡ï¼Œå¸¸è§çš„è®¡ç®—å…¬å¼æœ‰å¦‚ä¸‹å‡ ç§:

$$
Î± = \frac {1} {1+decay\_rate*epoch\_num} Î±_0
$$

> å¯¹æˆ‘è€Œè¨€ï¼Œå­¦ä¹ ç‡è¡°å‡å¹¶ä¸æ˜¯æˆ‘å°è¯•çš„è¦ç‚¹, è®¾ç½®ä¸€ä¸ªå›ºå®šçš„ Î±ï¼Œ ç„¶åå¥½å¥½è°ƒæ•´ï¼Œä¼šæœ‰å¾ˆå¤§å½±å“ï¼Œ å­¦ä¹ ç‡è¡°å‡çš„ç¡®å¤§æœ‰è£¨ç›Š, æœ‰æ—¶å€™å®ƒå¯ä»¥åŠ å¿«è®­ç»ƒ, ä½†è¿™å¹¶ä¸æ˜¯æˆ‘ä¼šç‡å…ˆå°è¯•çš„å†…å®¹. ä¸‹å‘¨æˆ‘ä»¬ä¼šé‡ç‚¹ä»‹ç» å¦‚ä½•ç®¡ç†å’Œé«˜æ•ˆæœç´¢ è¶…å‚æ•°.
> 
> For meï¼ŒI would say that learning rate decay usually lower down on the list of things I try. learning rate decay does help. Sometimes it can really help speed up training. it is a little bit lower down my list in terms of the thingsI would try.

## Reference

- [ç½‘æ˜“äº‘è¯¾å ‚ - deeplearning][1]
- [æ·±åº¦å­¦ä¹ ç¬”è®°ï¼šä¼˜åŒ–æ–¹æ³•æ€»ç»“(BGD,SGD,Momentum,AdaGrad,RMSProp,Adam)][2]
- [Deep Learning ä¹‹ æœ€ä¼˜åŒ–æ–¹æ³•][3]
- [æ·±åº¦å­¦ä¹ ä¼˜åŒ–ç®—æ³•è§£æ(Momentum, RMSProp, Adam)][4]
- [æœºå™¨ä¹‹å¿ƒ - ç¥ç»ç½‘ç»œè®­ç»ƒä¸­ï¼Œå‚»å‚»åˆ†ä¸æ¸…Epochã€Batch Sizeå’Œè¿­ä»£][6]

[1]: https://study.163.com/my#/smarts
[2]: https://blog.csdn.net/u014595019/article/details/52989301
[3]: https://blog.csdn.net/BVL10101111/article/details/72614711
[4]: https://blog.csdn.net/willduan1/article/details/78070086
[5]: http://www.cnblogs.com/marsggbo/
[6]: https://www.jiqizhixin.com/articles/2017-09-25-3
[7]: https://zhuanlan.zhihu.com/p/30743067


